\hypertarget{xmem_8c}{}\doxysection{platform/avr/xmem/xmem.c File Reference}
\label{xmem_8c}\index{platform/avr/xmem/xmem.c@{platform/avr/xmem/xmem.c}}
{\ttfamily \#include $<$xmem.\+h$>$}\newline
{\ttfamily \#include $<$spi.\+h$>$}\newline
{\ttfamily \#include $<$logger.\+h$>$}\newline
{\ttfamily \#include $<$gpio.\+h$>$}\newline
{\ttfamily \#include $<$avr/io.\+h$>$}\newline
{\ttfamily \#include $<$avr/pgmspace.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structAddrHelper}{Addr\+Helper}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{xmem_8c_a2fb26b27808ad3a8251329ef8d44d7dc}{MEMTEST\+\_\+\+SIMPLE}}
\item 
\#define \mbox{\hyperlink{xmem_8c_a41e71a45e1fd04415bc24952cbf50c9b}{BANK\+\_\+\+COUNT}}~3
\item 
\#define \mbox{\hyperlink{xmem_8c_ab15d51766a60c96accc9078415cb87d8}{BANK\+\_\+\+SIZE\+\_\+\+POT}}~17
\item 
\#define \mbox{\hyperlink{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}{BANK\+\_\+\+SIZE}}~0x20000\+UL
\item 
\#define \mbox{\hyperlink{xmem_8c_af6f22306e433d0d10bba1b7127d7e198}{OUTPUT\+\_\+\+INTERVAL}}~0x2000\+UL
\item 
\#define \mbox{\hyperlink{xmem_8c_a35beee7b0f2f3e294c4a4a69a5f02df4}{DUMMY}}~0x\+FF
\item 
\#define \mbox{\hyperlink{xmem_8c_ad350bae49f72ba58d73027f1316e38b8}{SEED}}~42
\item 
\#define \mbox{\hyperlink{xmem_8c_a5fdcd0ec5530b8e5b1110e54e30e0600}{SRAM\+\_\+\+COMMAND\+\_\+\+WRITE}}~2
\item 
\#define \mbox{\hyperlink{xmem_8c_aab517c0a80aa9e990d1475df041c2bb8}{SRAM\+\_\+\+COMMAND\+\_\+\+READ}}~3
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{xmem_8c_a43d00de5ed24219e463a551d8068ee48}{\+\_\+xmem\+\_\+start}} (\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} bank, \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} command, \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr)
\item 
static void \mbox{\hyperlink{xmem_8c_a06aceb6712fb500abaa5b4a361ef5c42}{\+\_\+memtest}} (void)
\item 
static void \mbox{\hyperlink{xmem_8c_a9aedb23adf01d0e4ce419cbf91499265}{\+\_\+xmem\+\_\+read}} (\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} bank, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} addr, void $\ast$data, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\item 
static void \mbox{\hyperlink{xmem_8c_af4355841d4c788c04e7facab16df13f6}{\+\_\+xmem\+\_\+write}} (\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} bank, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} addr, const void $\ast$data, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\item 
static void \mbox{\hyperlink{xmem_8c_a2382a8751ee6d4d5119bbf8f22e013e1}{\+\_\+xmem\+\_\+set}} (\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} bank, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} addr, \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} value, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\item 
static \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} \mbox{\hyperlink{xmem_8c_a6b1db5b6243ae3cc6a5cef75c25237ca}{\+\_\+addr\+\_\+to\+\_\+bank}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr)
\item 
static \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \mbox{\hyperlink{xmem_8c_a1ba823c5618e034e2a144c669347cf90}{\+\_\+addr\+\_\+bank\+\_\+offset}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr)
\item 
static void \mbox{\hyperlink{xmem_8c_ad5f6a204f590508c9d13d89813541f17}{\+\_\+xmem\+\_\+overlap}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size, \mbox{\hyperlink{structAddrHelper}{Addr\+Helper}} $\ast$h)
\item 
void \mbox{\hyperlink{xmem_8c_aa98b163510e84b9e79394397efdb8dde}{xmem\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initialize external memory and run memory test. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{xmem_8c_ac439854f5a1e0bd1b2f52c1028fc900a}{xmem\+\_\+read}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, void $\ast$data, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\begin{DoxyCompactList}\small\item\em Read the specified number of bytes from the external memory. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{xmem_8c_afef9c92490450d98f177f53f2b174f20}{xmem\+\_\+write}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, const void $\ast$data, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\begin{DoxyCompactList}\small\item\em Write the specified number of bytes to the external memory. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{xmem_8c_ab820b468ff9c382227cb704e6935a986}{xmem\+\_\+set}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} value, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\begin{DoxyCompactList}\small\item\em Set a specified number of bytes in the external memory to a value. \end{DoxyCompactList}\item 
\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \mbox{\hyperlink{xmem_8c_a4164d03f7168bc7c7d3ce75d27bc6547}{xmem\+\_\+size}} (void)
\begin{DoxyCompactList}\small\item\em Get external memory size. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Tim Gabrikowski, Anton Tchekov 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
01.\+05.\+2023 
\end{DoxyDate}


Definition in file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.



\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{xmem_8c_a41e71a45e1fd04415bc24952cbf50c9b}\label{xmem_8c_a41e71a45e1fd04415bc24952cbf50c9b}} 
\index{xmem.c@{xmem.c}!BANK\_COUNT@{BANK\_COUNT}}
\index{BANK\_COUNT@{BANK\_COUNT}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{BANK\_COUNT}{BANK\_COUNT}}
{\footnotesize\ttfamily \#define BANK\+\_\+\+COUNT~3}

How many memory banks there are 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00021}{21}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}\label{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}} 
\index{xmem.c@{xmem.c}!BANK\_SIZE@{BANK\_SIZE}}
\index{BANK\_SIZE@{BANK\_SIZE}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{BANK\_SIZE}{BANK\_SIZE}}
{\footnotesize\ttfamily \#define BANK\+\_\+\+SIZE~0x20000\+UL}

The size of each memory bank in bytes 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00027}{27}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_ab15d51766a60c96accc9078415cb87d8}\label{xmem_8c_ab15d51766a60c96accc9078415cb87d8}} 
\index{xmem.c@{xmem.c}!BANK\_SIZE\_POT@{BANK\_SIZE\_POT}}
\index{BANK\_SIZE\_POT@{BANK\_SIZE\_POT}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{BANK\_SIZE\_POT}{BANK\_SIZE\_POT}}
{\footnotesize\ttfamily \#define BANK\+\_\+\+SIZE\+\_\+\+POT~17}

The size of each memory bank as a power of two 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00024}{24}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_a35beee7b0f2f3e294c4a4a69a5f02df4}\label{xmem_8c_a35beee7b0f2f3e294c4a4a69a5f02df4}} 
\index{xmem.c@{xmem.c}!DUMMY@{DUMMY}}
\index{DUMMY@{DUMMY}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{DUMMY}{DUMMY}}
{\footnotesize\ttfamily \#define DUMMY~0x\+FF}

Dummy SPI value when receiving 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00033}{33}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_a2fb26b27808ad3a8251329ef8d44d7dc}\label{xmem_8c_a2fb26b27808ad3a8251329ef8d44d7dc}} 
\index{xmem.c@{xmem.c}!MEMTEST\_SIMPLE@{MEMTEST\_SIMPLE}}
\index{MEMTEST\_SIMPLE@{MEMTEST\_SIMPLE}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{MEMTEST\_SIMPLE}{MEMTEST\_SIMPLE}}
{\footnotesize\ttfamily \#define MEMTEST\+\_\+\+SIMPLE}

Do a simple checkerboard memory test. Comment this out to do a more thorough memory test using random numbers 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00018}{18}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_af6f22306e433d0d10bba1b7127d7e198}\label{xmem_8c_af6f22306e433d0d10bba1b7127d7e198}} 
\index{xmem.c@{xmem.c}!OUTPUT\_INTERVAL@{OUTPUT\_INTERVAL}}
\index{OUTPUT\_INTERVAL@{OUTPUT\_INTERVAL}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{OUTPUT\_INTERVAL}{OUTPUT\_INTERVAL}}
{\footnotesize\ttfamily \#define OUTPUT\+\_\+\+INTERVAL~0x2000\+UL}

The interval in bytes at which to do progress updates in a memory test 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00030}{30}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_ad350bae49f72ba58d73027f1316e38b8}\label{xmem_8c_ad350bae49f72ba58d73027f1316e38b8}} 
\index{xmem.c@{xmem.c}!SEED@{SEED}}
\index{SEED@{SEED}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{SEED}{SEED}}
{\footnotesize\ttfamily \#define SEED~42}

Random seed for extended memory test 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00036}{36}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_aab517c0a80aa9e990d1475df041c2bb8}\label{xmem_8c_aab517c0a80aa9e990d1475df041c2bb8}} 
\index{xmem.c@{xmem.c}!SRAM\_COMMAND\_READ@{SRAM\_COMMAND\_READ}}
\index{SRAM\_COMMAND\_READ@{SRAM\_COMMAND\_READ}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{SRAM\_COMMAND\_READ}{SRAM\_COMMAND\_READ}}
{\footnotesize\ttfamily \#define SRAM\+\_\+\+COMMAND\+\_\+\+READ~3}

Read block command 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00042}{42}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.

\mbox{\Hypertarget{xmem_8c_a5fdcd0ec5530b8e5b1110e54e30e0600}\label{xmem_8c_a5fdcd0ec5530b8e5b1110e54e30e0600}} 
\index{xmem.c@{xmem.c}!SRAM\_COMMAND\_WRITE@{SRAM\_COMMAND\_WRITE}}
\index{SRAM\_COMMAND\_WRITE@{SRAM\_COMMAND\_WRITE}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{SRAM\_COMMAND\_WRITE}{SRAM\_COMMAND\_WRITE}}
{\footnotesize\ttfamily \#define SRAM\+\_\+\+COMMAND\+\_\+\+WRITE~2}

Write block command 

Definition at line \mbox{\hyperlink{xmem_8c_source_l00039}{39}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{xmem_8c_a1ba823c5618e034e2a144c669347cf90}\label{xmem_8c_a1ba823c5618e034e2a144c669347cf90}} 
\index{xmem.c@{xmem.c}!\_addr\_bank\_offset@{\_addr\_bank\_offset}}
\index{\_addr\_bank\_offset@{\_addr\_bank\_offset}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_addr\_bank\_offset()}{\_addr\_bank\_offset()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \+\_\+addr\+\_\+bank\+\_\+offset (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00180}{180}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00181\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{return}\ addr\ \&\ (\mbox{\hyperlink{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}{BANK\_SIZE}}\ -\/\ 1);}
\DoxyCodeLine{00183\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_a6b1db5b6243ae3cc6a5cef75c25237ca}\label{xmem_8c_a6b1db5b6243ae3cc6a5cef75c25237ca}} 
\index{xmem.c@{xmem.c}!\_addr\_to\_bank@{\_addr\_to\_bank}}
\index{\_addr\_to\_bank@{\_addr\_to\_bank}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_addr\_to\_bank()}{\_addr\_to\_bank()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} \+\_\+addr\+\_\+to\+\_\+bank (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00175}{175}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00176\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{return}\ addr\ >>\ \mbox{\hyperlink{xmem_8c_ab15d51766a60c96accc9078415cb87d8}{BANK\_SIZE\_POT}};}
\DoxyCodeLine{00178\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_a06aceb6712fb500abaa5b4a361ef5c42}\label{xmem_8c_a06aceb6712fb500abaa5b4a361ef5c42}} 
\index{xmem.c@{xmem.c}!\_memtest@{\_memtest}}
\index{\_memtest@{\_memtest}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_memtest()}{\_memtest()}}
{\footnotesize\ttfamily static void \+\_\+memtest (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00054}{54}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00055\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ bank,\ w,\ v;}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}\ i;}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{/*\ Run\ checkerboard\ memory\ test\ */}}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}Starting\ complete\ memory\ test"{}}));}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{spi_8c_ab3e16cf26638212c1e54a7aa4878e12a}{spi\_fast}}();}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{for}(bank\ =\ 0;\ bank\ <\ \mbox{\hyperlink{xmem_8c_a41e71a45e1fd04415bc24952cbf50c9b}{BANK\_COUNT}};\ ++bank)}
\DoxyCodeLine{00064\ \ \ \ \ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}Testing\ memory\ bank\ [\%02d]"{}}),\ bank\ +\ 1);}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Write\ */}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}Writing\ pattern"{}}));}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \_xmem\_start(bank,\ \mbox{\hyperlink{xmem_8c_a5fdcd0ec5530b8e5b1110e54e30e0600}{SRAM\_COMMAND\_WRITE}},\ 0);}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#ifdef\ MEMTEST\_SIMPLE}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ v\ =\ 0xAA;}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ srand(\mbox{\hyperlink{xmem_8c_ad350bae49f72ba58d73027f1316e38b8}{SEED}});}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 0;\ ;\ ++i)}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#ifdef\ MEMTEST\_SIMPLE}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ \string~v;}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{rand_8c_a9eeb6c44d48cd8ace4b454da982406c9}{rand}}();}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ \%\ \mbox{\hyperlink{xmem_8c_af6f22306e433d0d10bba1b7127d7e198}{OUTPUT\_INTERVAL}}\ ==\ 0)}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_EXT,\ PSTR(\textcolor{stringliteral}{"{}0x\%06lX"{}}),\ i);}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ >=\ \mbox{\hyperlink{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}{BANK\_SIZE}})}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(v);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gpio_8h_a89171c2905e37752be2059880ed9f720}{XMEM\_DESELECT}}(bank);}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Read\ */}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}Verifying\ pattern"{}}));}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \_xmem\_start(bank,\ \mbox{\hyperlink{xmem_8c_aab517c0a80aa9e990d1475df041c2bb8}{SRAM\_COMMAND\_READ}},\ 0);}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#ifdef\ MEMTEST\_SIMPLE}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ v\ =\ 0xAA;}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ srand(\mbox{\hyperlink{xmem_8c_ad350bae49f72ba58d73027f1316e38b8}{SEED}});}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 0;\ ;\ ++i)}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#ifdef\ MEMTEST\_SIMPLE}}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ \string~v;}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ v\ =\ \mbox{\hyperlink{rand_8c_a9eeb6c44d48cd8ace4b454da982406c9}{rand}}();}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ \%\ \mbox{\hyperlink{xmem_8c_af6f22306e433d0d10bba1b7127d7e198}{OUTPUT\_INTERVAL}}\ ==\ 0)}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_EXT,\ PSTR(\textcolor{stringliteral}{"{}0x\%06lX"{}}),\ i);}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(i\ >=\ \mbox{\hyperlink{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}{BANK\_SIZE}})}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ w\ =\ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(\mbox{\hyperlink{xmem_8c_a35beee7b0f2f3e294c4a4a69a5f02df4}{DUMMY}});}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(w\ !=\ v)}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gpio_8h_a89171c2905e37752be2059880ed9f720}{XMEM\_DESELECT}}(bank);}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8c_a19a313011d8f478ad9799e546199a9ac}{panic}}(PSTR(}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Memory\ test\ failed\ at\ address\ 0x\%06lX\(\backslash\)n"{}}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ [0x\%02X\ !=\ 0x\%02X]"{}}),}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ i,\ w,\ v);}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{gpio_8h_a89171c2905e37752be2059880ed9f720}{XMEM\_DESELECT}}(bank);}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_ad5f6a204f590508c9d13d89813541f17}\label{xmem_8c_ad5f6a204f590508c9d13d89813541f17}} 
\index{xmem.c@{xmem.c}!\_xmem\_overlap@{\_xmem\_overlap}}
\index{\_xmem\_overlap@{\_xmem\_overlap}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_xmem\_overlap()}{\_xmem\_overlap()}}
{\footnotesize\ttfamily static void \+\_\+xmem\+\_\+overlap (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size,  }\item[{\mbox{\hyperlink{structAddrHelper}{Addr\+Helper}} $\ast$}]{h }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00204}{204}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00205\ \{}
\DoxyCodeLine{00206\ \ \ \ \ \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}\ addr\_end;}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ h-\/>\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}}\ =\ \_addr\_bank\_offset(addr);}
\DoxyCodeLine{00209\ \ \ \ \ addr\_end\ =\ addr\ +\ size;}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ h-\/>\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}}\ =\ \_addr\_to\_bank(addr);}
\DoxyCodeLine{00212\ \ \ \ \ h-\/>\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ =\ \_addr\_to\_bank(addr\_end);}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{if}(h-\/>\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}}\ ==\ h-\/>\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}})}
\DoxyCodeLine{00214\ \ \ \ \ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ h-\/>\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}}\ =\ size;}
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00218\ \ \ \ \ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ h-\/>\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}}\ =\ \_addr\_bank\_offset(addr\_end);}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ h-\/>\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}}\ =\ size\ -\/\ h-\/>\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}};}
\DoxyCodeLine{00221\ \ \ \ \ \}}
\DoxyCodeLine{00222\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_a9aedb23adf01d0e4ce419cbf91499265}\label{xmem_8c_a9aedb23adf01d0e4ce419cbf91499265}} 
\index{xmem.c@{xmem.c}!\_xmem\_read@{\_xmem\_read}}
\index{\_xmem\_read@{\_xmem\_read}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_xmem\_read()}{\_xmem\_read()}}
{\footnotesize\ttfamily static void \+\_\+xmem\+\_\+read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{bank,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{addr,  }\item[{void $\ast$}]{data,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00137}{137}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00138\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}\ i;}
\DoxyCodeLine{00140\ \ \ \ \ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ *data8\ =\ data;}
\DoxyCodeLine{00141\ \ \ \ \ \_xmem\_start(bank,\ \mbox{\hyperlink{xmem_8c_aab517c0a80aa9e990d1475df041c2bb8}{SRAM\_COMMAND\_READ}},\ addr);}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 0;\ i\ <\ size;\ ++i)}
\DoxyCodeLine{00143\ \ \ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ data8[i]\ =\ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(\mbox{\hyperlink{xmem_8c_a35beee7b0f2f3e294c4a4a69a5f02df4}{DUMMY}});}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \mbox{\hyperlink{gpio_8h_a89171c2905e37752be2059880ed9f720}{XMEM\_DESELECT}}(bank);}
\DoxyCodeLine{00148\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_a2382a8751ee6d4d5119bbf8f22e013e1}\label{xmem_8c_a2382a8751ee6d4d5119bbf8f22e013e1}} 
\index{xmem.c@{xmem.c}!\_xmem\_set@{\_xmem\_set}}
\index{\_xmem\_set@{\_xmem\_set}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_xmem\_set()}{\_xmem\_set()}}
{\footnotesize\ttfamily static void \+\_\+xmem\+\_\+set (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{bank,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{addr,  }\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{value,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00163}{163}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00164\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}\ i;}
\DoxyCodeLine{00166\ \ \ \ \ \_xmem\_start(bank,\ \mbox{\hyperlink{xmem_8c_a5fdcd0ec5530b8e5b1110e54e30e0600}{SRAM\_COMMAND\_WRITE}},\ addr);}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 0;\ i\ <\ size;\ ++i)}
\DoxyCodeLine{00168\ \ \ \ \ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(value);}
\DoxyCodeLine{00170\ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \mbox{\hyperlink{gpio_8h_a89171c2905e37752be2059880ed9f720}{XMEM\_DESELECT}}(bank);}
\DoxyCodeLine{00173\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_a43d00de5ed24219e463a551d8068ee48}\label{xmem_8c_a43d00de5ed24219e463a551d8068ee48}} 
\index{xmem.c@{xmem.c}!\_xmem\_start@{\_xmem\_start}}
\index{\_xmem\_start@{\_xmem\_start}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_xmem\_start()}{\_xmem\_start()}}
{\footnotesize\ttfamily static void \+\_\+xmem\+\_\+start (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{bank,  }\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{command,  }\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00045}{45}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00046\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{gpio_8h_a43c615a50c44cc38e470b7648df5d609}{XMEM\_SELECT}}(bank);}
\DoxyCodeLine{00048\ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(command);}
\DoxyCodeLine{00049\ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(addr\ >>\ 16);}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(addr\ >>\ 8);}
\DoxyCodeLine{00051\ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(addr);}
\DoxyCodeLine{00052\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_af4355841d4c788c04e7facab16df13f6}\label{xmem_8c_af4355841d4c788c04e7facab16df13f6}} 
\index{xmem.c@{xmem.c}!\_xmem\_write@{\_xmem\_write}}
\index{\_xmem\_write@{\_xmem\_write}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{\_xmem\_write()}{\_xmem\_write()}}
{\footnotesize\ttfamily static void \+\_\+xmem\+\_\+write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{bank,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{addr,  }\item[{const void $\ast$}]{data,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line \mbox{\hyperlink{xmem_8c_source_l00150}{150}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00151\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}\ i;}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ *data8\ =\ data;}
\DoxyCodeLine{00154\ \ \ \ \ \_xmem\_start(bank,\ \mbox{\hyperlink{xmem_8c_a5fdcd0ec5530b8e5b1110e54e30e0600}{SRAM\_COMMAND\_WRITE}},\ addr);}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 0;\ i\ <\ size;\ ++i)}
\DoxyCodeLine{00156\ \ \ \ \ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{spi_8c_aa100766918afcb71b6ba79413f33f9db}{spi\_xchg}}(data8[i]);}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \mbox{\hyperlink{gpio_8h_a89171c2905e37752be2059880ed9f720}{XMEM\_DESELECT}}(bank);}
\DoxyCodeLine{00161\ \}}

\end{DoxyCode}
\mbox{\Hypertarget{xmem_8c_aa98b163510e84b9e79394397efdb8dde}\label{xmem_8c_aa98b163510e84b9e79394397efdb8dde}} 
\index{xmem.c@{xmem.c}!xmem\_init@{xmem\_init}}
\index{xmem\_init@{xmem\_init}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{xmem\_init()}{xmem\_init()}}
{\footnotesize\ttfamily void xmem\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize external memory and run memory test. 



Definition at line \mbox{\hyperlink{xmem_8c_source_l00225}{225}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00226\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ XMEM\ */}}
\DoxyCodeLine{00228\ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}External\ memory\ driver\ initialized"{}}));}
\DoxyCodeLine{00229\ \ \ \ \ \_memtest();}
\DoxyCodeLine{00230\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{logger_8c_source_l00164}{log\+\_\+boot\+\_\+\+P()}}.

\mbox{\Hypertarget{xmem_8c_ac439854f5a1e0bd1b2f52c1028fc900a}\label{xmem_8c_ac439854f5a1e0bd1b2f52c1028fc900a}} 
\index{xmem.c@{xmem.c}!xmem\_read@{xmem\_read}}
\index{xmem\_read@{xmem\_read}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{xmem\_read()}{xmem\_read()}}
{\footnotesize\ttfamily void xmem\+\_\+read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{void $\ast$}]{data,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})}



Read the specified number of bytes from the external memory. 


\begin{DoxyParams}{Parameters}
{\em addr} & Start address \\
\hline
{\em data} & Destination buffer \\
\hline
{\em size} & Number of bytes to read \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00232}{232}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00233\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \mbox{\hyperlink{structAddrHelper}{AddrHelper}}\ h;}
\DoxyCodeLine{00235\ \ \ \ \ \_xmem\_overlap(addr,\ size,\ \&h);}
\DoxyCodeLine{00236\ \ \ \ \ \_xmem\_read(h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}},\ h.\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}},\ data,\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}});}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{if}(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ !=\ h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}})}
\DoxyCodeLine{00238\ \ \ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \_xmem\_read(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}},\ 0,\ (\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ *)data\ +\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}},\ h.\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}});}
\DoxyCodeLine{00240\ \ \ \ \ \}}
\DoxyCodeLine{00241\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00195}{Addr\+Helper\+::\+Addr\+First}}, \mbox{\hyperlink{xmem_8c_source_l00189}{Addr\+Helper\+::\+Bank\+First}}, \mbox{\hyperlink{xmem_8c_source_l00192}{Addr\+Helper\+::\+Bank\+Second}}, \mbox{\hyperlink{xmem_8c_source_l00198}{Addr\+Helper\+::\+Size\+First}}, and \mbox{\hyperlink{xmem_8c_source_l00201}{Addr\+Helper\+::\+Size\+Second}}.



Referenced by \mbox{\hyperlink{avr_2platform_8c_source_l00024}{env\+\_\+memory\+\_\+read()}}, and \mbox{\hyperlink{lcd_8c_source_l00506}{lcd\+\_\+image\+\_\+1bit()}}.

\mbox{\Hypertarget{xmem_8c_ab820b468ff9c382227cb704e6935a986}\label{xmem_8c_ab820b468ff9c382227cb704e6935a986}} 
\index{xmem.c@{xmem.c}!xmem\_set@{xmem\_set}}
\index{xmem\_set@{xmem\_set}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{xmem\_set()}{xmem\_set()}}
{\footnotesize\ttfamily void xmem\+\_\+set (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{value,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})}



Set a specified number of bytes in the external memory to a value. 


\begin{DoxyParams}{Parameters}
{\em addr} & Start address \\
\hline
{\em value} & The value to write \\
\hline
{\em size} & Number of bytes to set \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00255}{255}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00256\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \mbox{\hyperlink{structAddrHelper}{AddrHelper}}\ h;}
\DoxyCodeLine{00258\ \ \ \ \ \_xmem\_overlap(addr,\ size,\ \&h);}
\DoxyCodeLine{00259\ \ \ \ \ \_xmem\_set(h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}},\ h.\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}},\ value,\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}});}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordflow}{if}(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ !=\ h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}})}
\DoxyCodeLine{00261\ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \_xmem\_set(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}},\ 0,\ value,\ h.\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}});}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00195}{Addr\+Helper\+::\+Addr\+First}}, \mbox{\hyperlink{xmem_8c_source_l00189}{Addr\+Helper\+::\+Bank\+First}}, \mbox{\hyperlink{xmem_8c_source_l00192}{Addr\+Helper\+::\+Bank\+Second}}, \mbox{\hyperlink{xmem_8c_source_l00198}{Addr\+Helper\+::\+Size\+First}}, and \mbox{\hyperlink{xmem_8c_source_l00201}{Addr\+Helper\+::\+Size\+Second}}.

\mbox{\Hypertarget{xmem_8c_a4164d03f7168bc7c7d3ce75d27bc6547}\label{xmem_8c_a4164d03f7168bc7c7d3ce75d27bc6547}} 
\index{xmem.c@{xmem.c}!xmem\_size@{xmem\_size}}
\index{xmem\_size@{xmem\_size}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{xmem\_size()}{xmem\_size()}}
{\footnotesize\ttfamily \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} xmem\+\_\+size (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Get external memory size. 

\begin{DoxyReturn}{Returns}
Size of the external memory in bytes 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00266}{266}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00267\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{xmem_8c_a41e71a45e1fd04415bc24952cbf50c9b}{BANK\_COUNT}}\ *\ \mbox{\hyperlink{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}{BANK\_SIZE}};}
\DoxyCodeLine{00269\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00021}{BANK\+\_\+\+COUNT}}, and \mbox{\hyperlink{xmem_8c_source_l00027}{BANK\+\_\+\+SIZE}}.



Referenced by \mbox{\hyperlink{avr_2platform_8c_source_l00019}{env\+\_\+memory\+\_\+size()}}.

\mbox{\Hypertarget{xmem_8c_afef9c92490450d98f177f53f2b174f20}\label{xmem_8c_afef9c92490450d98f177f53f2b174f20}} 
\index{xmem.c@{xmem.c}!xmem\_write@{xmem\_write}}
\index{xmem\_write@{xmem\_write}!xmem.c@{xmem.c}}
\doxysubsubsection{\texorpdfstring{xmem\_write()}{xmem\_write()}}
{\footnotesize\ttfamily void xmem\+\_\+write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{const void $\ast$}]{data,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})}



Write the specified number of bytes to the external memory. 


\begin{DoxyParams}{Parameters}
{\em addr} & Start address \\
\hline
{\em data} & Source buffer \\
\hline
{\em size} & Number of bytes to write \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00243}{243}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00244\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \mbox{\hyperlink{structAddrHelper}{AddrHelper}}\ h;}
\DoxyCodeLine{00246\ \ \ \ \ \_xmem\_overlap(addr,\ size,\ \&h);}
\DoxyCodeLine{00247\ \ \ \ \ \_xmem\_write(h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}},\ h.\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}},\ data,\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}});}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keywordflow}{if}(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ !=\ h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}})}
\DoxyCodeLine{00249\ \ \ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \_xmem\_write(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}},\ 0,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ *)data\ +\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}},}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ h.\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}});}
\DoxyCodeLine{00252\ \ \ \ \ \}}
\DoxyCodeLine{00253\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00195}{Addr\+Helper\+::\+Addr\+First}}, \mbox{\hyperlink{xmem_8c_source_l00189}{Addr\+Helper\+::\+Bank\+First}}, \mbox{\hyperlink{xmem_8c_source_l00192}{Addr\+Helper\+::\+Bank\+Second}}, \mbox{\hyperlink{xmem_8c_source_l00198}{Addr\+Helper\+::\+Size\+First}}, and \mbox{\hyperlink{xmem_8c_source_l00201}{Addr\+Helper\+::\+Size\+Second}}.



Referenced by \mbox{\hyperlink{avr_2platform_8c_source_l00029}{env\+\_\+memory\+\_\+write()}}, and \mbox{\hyperlink{initrd_8c_source_l00027}{initrd\+\_\+load()}}.

