\doxysection{temp/fs/fs.h File Reference}
\hypertarget{fs_8h}{}\label{fs_8h}\index{temp/fs/fs.h@{temp/fs/fs.h}}


\doxylink{structFile}{File} system access.  


{\ttfamily \#include $<$status.\+h$>$}\newline
{\ttfamily \#include $<$types.\+h$>$}\newline
{\ttfamily \#include $<$atfs.\+h$>$}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structFile}{File}}
\item 
struct \mbox{\hyperlink{structDir}{Dir}}
\item 
struct \mbox{\hyperlink{structDirEntry}{Dir\+Entry}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{fs_8h_ae1df2fb5ed0eb11b2636be3207395e17}{path\+\_\+join}} (char \texorpdfstring{$\ast$}{*}path, const char \texorpdfstring{$\ast$}{*}append)
\begin{DoxyCompactList}\small\item\em Join two paths by copying the second path to the end of the first path and adding a dot in between. The first string must have enough space to contain the whole path. The validity of the path is not checked. \end{DoxyCompactList}\item 
char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{fs_8h_a143f4d56d1fe14d2798428d438ba6d8d}{path\+\_\+parent}} (char \texorpdfstring{$\ast$}{*}path)
\begin{DoxyCompactList}\small\item\em Remove the last component of the path in place. The validity of the path is not checked. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{fs_8h_a7d8bf1a0e56adf07abc7792f2667199e}{path\+\_\+valid}} (const char \texorpdfstring{$\ast$}{*}path)
\begin{DoxyCompactList}\small\item\em Check if a path is valid. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{fs_8h_a3d7a42239d590a1d9a534002f637ceb7}{identifier\+\_\+valid}} (const char \texorpdfstring{$\ast$}{*}path)
\begin{DoxyCompactList}\small\item\em Check if a identifier is valid. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_aa2157dd7489909ac9b1fd0c5a1e95dd7}{fs\+\_\+format}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} disk)
\begin{DoxyCompactList}\small\item\em Format disk with ATFS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_a8324edeaa56757f38563177f3a3b6836}{fs\+\_\+mount}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} disk, const char \texorpdfstring{$\ast$}{*}ident)
\begin{DoxyCompactList}\small\item\em Mount disk with ATFS. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_a0b33383a73a74cc1726fbdc3b6df7cfb}{fs\+\_\+fcreate}} (const char \texorpdfstring{$\ast$}{*}path, \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} size)
\begin{DoxyCompactList}\small\item\em Create a file. If the file already exists, it is resized to the specified size. When a file is resized, all file handles to it are invalidated and need to be reopened. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_ab081faf9fb8d16dd7e00988a210f55a1}{fs\+\_\+fopen}} (const char \texorpdfstring{$\ast$}{*}path, \mbox{\hyperlink{structFile}{File}} \texorpdfstring{$\ast$}{*}file)
\begin{DoxyCompactList}\small\item\em Open a file to get a file handle. It is not neccessary to close a file, therefore there is no {\ttfamily fs\+\_\+fclose} function. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_a17bf6e1159e5e88ed4529b80f2091d9a}{fs\+\_\+fread}} (\mbox{\hyperlink{structFile}{File}} \texorpdfstring{$\ast$}{*}file, \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} block, void \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Reads one block from the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_ade85fb2d3dc6e58f8364ac780255732f}{fs\+\_\+fwrite}} (\mbox{\hyperlink{structFile}{File}} \texorpdfstring{$\ast$}{*}file, \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} block, const void \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Write one block to the file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_ad46125ec30ef3c86d5f9dc7414541d4e}{fs\+\_\+delete}} (const char \texorpdfstring{$\ast$}{*}path)
\begin{DoxyCompactList}\small\item\em Recursively delete a files and directories. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_a9e81e00c6751de4244769f35c74b9aca}{fs\+\_\+rename}} (const char \texorpdfstring{$\ast$}{*}dest, const char \texorpdfstring{$\ast$}{*}src)
\begin{DoxyCompactList}\small\item\em Move or rename a file or a directory. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_aa4b6918928b9c7a48d799ba1e0f8b4dc}{fs\+\_\+copy}} (const char \texorpdfstring{$\ast$}{*}dest, const char \texorpdfstring{$\ast$}{*}src)
\begin{DoxyCompactList}\small\item\em Recursively copy files and directories. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_ac68fc896890e0d13a73a431d4a1d79ef}{fs\+\_\+dopen}} (const char \texorpdfstring{$\ast$}{*}path, \mbox{\hyperlink{structDir}{Dir}} \texorpdfstring{$\ast$}{*}dir)
\begin{DoxyCompactList}\small\item\em Open a directory. \end{DoxyCompactList}\item 
\mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} \mbox{\hyperlink{fs_8h_a1df6e8dfae82b2dc9e7cb3c9b8b14472}{fs\+\_\+dread}} (\mbox{\hyperlink{structDir}{Dir}} \texorpdfstring{$\ast$}{*}dir, \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} index, \mbox{\hyperlink{structDirEntry}{Dir\+Entry}} \texorpdfstring{$\ast$}{*}entry)
\begin{DoxyCompactList}\small\item\em Read a directory entry. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\doxylink{structFile}{File} system access. 

\begin{DoxyAuthor}{Author}
Tim Gabrikowski, Anton Tchekov 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
23.\+04.\+2023 
\end{DoxyDate}


Definition in file \mbox{\hyperlink{fs_8h_source}{fs.\+h}}.



\doxysubsection{Function Documentation}
\Hypertarget{fs_8h_aa4b6918928b9c7a48d799ba1e0f8b4dc}\label{fs_8h_aa4b6918928b9c7a48d799ba1e0f8b4dc} 
\index{fs.h@{fs.h}!fs\_copy@{fs\_copy}}
\index{fs\_copy@{fs\_copy}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_copy()}{fs\_copy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+copy (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{dest,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{src }\end{DoxyParamCaption})}



Recursively copy files and directories. 


\begin{DoxyParams}{Parameters}
{\em dest} & Destination path \\
\hline
{\em src} & Source path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00405}{405}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00406\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00408\ \ \ \ \ (void)dest,\ (\textcolor{keywordtype}{void})src;}
\DoxyCodeLine{00409\ \}}

\end{DoxyCode}
\Hypertarget{fs_8h_ad46125ec30ef3c86d5f9dc7414541d4e}\label{fs_8h_ad46125ec30ef3c86d5f9dc7414541d4e} 
\index{fs.h@{fs.h}!fs\_delete@{fs\_delete}}
\index{fs\_delete@{fs\_delete}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_delete()}{fs\_delete()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+delete (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path }\end{DoxyParamCaption})}



Recursively delete a files and directories. 


\begin{DoxyParams}{Parameters}
{\em path} & Path to file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00387}{387}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00388\ \{}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00390\ \ \ \ \ (void)path;}
\DoxyCodeLine{00391\ \}}

\end{DoxyCode}
\Hypertarget{fs_8h_ac68fc896890e0d13a73a431d4a1d79ef}\label{fs_8h_ac68fc896890e0d13a73a431d4a1d79ef} 
\index{fs.h@{fs.h}!fs\_dopen@{fs\_dopen}}
\index{fs\_dopen@{fs\_dopen}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_dopen()}{fs\_dopen()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+dopen (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path,  }\item[{\mbox{\hyperlink{structDir}{Dir}} \texorpdfstring{$\ast$}{*}}]{dir }\end{DoxyParamCaption})}



Open a directory. 


\begin{DoxyParams}{Parameters}
{\em path} & Path to directory \\
\hline
{\em dir} & Output parameter directory handle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00411}{411}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00412\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ buf[\mbox{\hyperlink{atfs_8h_a92b9c24f31f47693e78b3f27be5905ed}{ATFS\_BLOCK\_SIZE}}];}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \mbox{\hyperlink{status_8h_a99cfc2ffa79fcbac77f8df8bea625959}{RETURN\_IF}}(\mbox{\hyperlink{fs_8c_ab081faf9fb8d16dd7e00988a210f55a1}{fs\_fopen}}(path,\ \&dir-\/>\mbox{\hyperlink{structDir_a409746d0bc850223abee98e0305d73b0}{InternalFile}}));}
\DoxyCodeLine{00416\ \ \ \ \ \mbox{\hyperlink{status_8h_a99cfc2ffa79fcbac77f8df8bea625959}{RETURN\_IF}}(\mbox{\hyperlink{fs_8c_a17bf6e1159e5e88ed4529b80f2091d9a}{fs\_fread}}(\&dir-\/>\mbox{\hyperlink{structDir_a409746d0bc850223abee98e0305d73b0}{InternalFile}},\ 0,\ buf));}
\DoxyCodeLine{00417\ \ \ \ \ dir-\/>\mbox{\hyperlink{structDir_ab3941ad1b2e3c8f069c9dcafb40abe21}{NumEntries}}\ =\ \mbox{\hyperlink{atfs_8h_a58dff0b38327e2389ba33ca793d2b633}{load\_le\_32}}(buf);}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00419\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{atfs_8h_source_l00024}{ATFS\+\_\+\+BLOCK\+\_\+\+SIZE}}, \mbox{\hyperlink{fs_8c_source_l00317}{fs\+\_\+fopen()}}, \mbox{\hyperlink{fs_8c_source_l00366}{fs\+\_\+fread()}}, \mbox{\hyperlink{fs_8h_source_l00033}{Dir\+::\+Internal\+File}}, \mbox{\hyperlink{atfs_8h_source_l00115}{load\+\_\+le\+\_\+32()}}, \mbox{\hyperlink{fs_8h_source_l00030}{Dir\+::\+Num\+Entries}}, and \mbox{\hyperlink{status_8h_source_l00029}{RETURN\+\_\+\+IF}}.

\Hypertarget{fs_8h_a1df6e8dfae82b2dc9e7cb3c9b8b14472}\label{fs_8h_a1df6e8dfae82b2dc9e7cb3c9b8b14472} 
\index{fs.h@{fs.h}!fs\_dread@{fs\_dread}}
\index{fs\_dread@{fs\_dread}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_dread()}{fs\_dread()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+dread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structDir}{Dir}} \texorpdfstring{$\ast$}{*}}]{dir,  }\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{index,  }\item[{\mbox{\hyperlink{structDirEntry}{Dir\+Entry}} \texorpdfstring{$\ast$}{*}}]{entry }\end{DoxyParamCaption})}



Read a directory entry. 


\begin{DoxyParams}{Parameters}
{\em dir} & Directory handle \\
\hline
{\em index} & \doxylink{structFile}{File} index \\
\hline
{\em entry} & Output parameter directory entry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00421}{421}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00422\ \{}
\DoxyCodeLine{00423\ \ \ \ \ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ buf[\mbox{\hyperlink{atfs_8h_a92b9c24f31f47693e78b3f27be5905ed}{ATFS\_BLOCK\_SIZE}}];}
\DoxyCodeLine{00424\ \ \ \ \ \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}\ offset,\ block;}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordflow}{if}(index\ >=\ dir-\/>\mbox{\hyperlink{structDir_ab3941ad1b2e3c8f069c9dcafb40abe21}{NumEntries}})}
\DoxyCodeLine{00427\ \ \ \ \ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OUT\_OF\_BOUNDS;}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{comment}{/*\ Add\ one\ because\ the\ first\ directory\ entry\ is\ reserved\ for\ metadata\ */}}
\DoxyCodeLine{00432\ \ \ \ \ offset\ =\ (index\ +\ 1)\ *\ \mbox{\hyperlink{atfs_8h_aa26cdea9ea502ca73d60b46f6dcdbb9d}{ATFS\_DIR\_ENTRY\_SIZE}};}
\DoxyCodeLine{00433\ \ \ \ \ block\ =\ offset\ /\ \mbox{\hyperlink{atfs_8h_a92b9c24f31f47693e78b3f27be5905ed}{ATFS\_BLOCK\_SIZE}};}
\DoxyCodeLine{00434\ \ \ \ \ offset\ -\/=\ block\ *\ \mbox{\hyperlink{atfs_8h_a92b9c24f31f47693e78b3f27be5905ed}{ATFS\_BLOCK\_SIZE}};}
\DoxyCodeLine{00435\ \ \ \ \ \mbox{\hyperlink{status_8h_a99cfc2ffa79fcbac77f8df8bea625959}{RETURN\_IF}}(\mbox{\hyperlink{fs_8c_a17bf6e1159e5e88ed4529b80f2091d9a}{fs\_fread}}(\&dir-\/>\mbox{\hyperlink{structDir_a409746d0bc850223abee98e0305d73b0}{InternalFile}},\ block,\ buf));}
\DoxyCodeLine{00436\ \ \ \ \ \mbox{\hyperlink{fs_8c_a556bcd94d1fd4eaab27b0ff8f75ed8a6}{dir\_entry\_get}}(buf\ +\ offset,\ entry);}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00438\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{atfs_8h_source_l00024}{ATFS\+\_\+\+BLOCK\+\_\+\+SIZE}}, \mbox{\hyperlink{atfs_8h_source_l00066}{ATFS\+\_\+\+DIR\+\_\+\+ENTRY\+\_\+\+SIZE}}, \mbox{\hyperlink{fs_8c_source_l00062}{dir\+\_\+entry\+\_\+get()}}, \mbox{\hyperlink{fs_8c_source_l00366}{fs\+\_\+fread()}}, \mbox{\hyperlink{fs_8h_source_l00033}{Dir\+::\+Internal\+File}}, \mbox{\hyperlink{fs_8h_source_l00030}{Dir\+::\+Num\+Entries}}, and \mbox{\hyperlink{status_8h_source_l00029}{RETURN\+\_\+\+IF}}.

\Hypertarget{fs_8h_a0b33383a73a74cc1726fbdc3b6df7cfb}\label{fs_8h_a0b33383a73a74cc1726fbdc3b6df7cfb} 
\index{fs.h@{fs.h}!fs\_fcreate@{fs\_fcreate}}
\index{fs\_fcreate@{fs\_fcreate}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_fcreate()}{fs\_fcreate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+fcreate (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path,  }\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{size }\end{DoxyParamCaption})}



Create a file. If the file already exists, it is resized to the specified size. When a file is resized, all file handles to it are invalidated and need to be reopened. 


\begin{DoxyParams}{Parameters}
{\em path} & Path to file \\
\hline
{\em size} & Capacity of the file in blocks \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00257}{257}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00258\ \{}
\DoxyCodeLine{00259\ \textcolor{preprocessor}{\ \ \ \ \#ifdef\ AAA}}
\DoxyCodeLine{00260\ \ \ \ \ \mbox{\hyperlink{structDir}{Dir}}\ dir;}
\DoxyCodeLine{00261\ \ \ \ \ \mbox{\hyperlink{structDirEntry}{DirEntry}}\ entry;}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{if}(\_traverse(path,\ \&dir))}
\DoxyCodeLine{00263\ \ \ \ \ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}\ start;}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ New\ file\ */}}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{status_8h_a99cfc2ffa79fcbac77f8df8bea625959}{RETURN\_IF}}(\mbox{\hyperlink{fs_8c_aecca187da843f43e0961f38f6086e037}{fs\_alloc}}(size,\ \&start));}
\DoxyCodeLine{00268\ \ \ \ \ \}}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(file.SizeBlocks\ !=\ size)}
\DoxyCodeLine{00270\ \ \ \ \ \{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ TODO:\ Resize\ file\ */}}
\DoxyCodeLine{00272\ \ \ \ \ \}}
\DoxyCodeLine{00273\ \textcolor{preprocessor}{\ \ \ \ \#endif}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00276\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fs_8c_source_l00121}{fs\+\_\+alloc()}}, and \mbox{\hyperlink{status_8h_source_l00029}{RETURN\+\_\+\+IF}}.

\Hypertarget{fs_8h_ab081faf9fb8d16dd7e00988a210f55a1}\label{fs_8h_ab081faf9fb8d16dd7e00988a210f55a1} 
\index{fs.h@{fs.h}!fs\_fopen@{fs\_fopen}}
\index{fs\_fopen@{fs\_fopen}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_fopen()}{fs\_fopen()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+fopen (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path,  }\item[{\mbox{\hyperlink{structFile}{File}} \texorpdfstring{$\ast$}{*}}]{file }\end{DoxyParamCaption})}



Open a file to get a file handle. It is not neccessary to close a file, therefore there is no {\ttfamily fs\+\_\+fclose} function. 


\begin{DoxyParams}{Parameters}
{\em path} & Path to file \\
\hline
{\em file} & Output parameter file handle \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00317}{317}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00318\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ buf[\mbox{\hyperlink{atfs_8h_a92b9c24f31f47693e78b3f27be5905ed}{ATFS\_BLOCK\_SIZE}}];}
\DoxyCodeLine{00320\ \ \ \ \ \mbox{\hyperlink{structDirEntry}{DirEntry}}\ entry;}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *s,\ *name;}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordtype}{char}\ c;}
\DoxyCodeLine{00323\ \ \ \ \ \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}\ name\_len;}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{comment}{/*\ Check\ path\ format\ beforehand\ for\ simplicity\ */}}
\DoxyCodeLine{00326\ \ \ \ \ \textcolor{keywordflow}{if}(!\mbox{\hyperlink{fs_8c_a7d8bf1a0e56adf07abc7792f2667199e}{path\_valid}}(path))}
\DoxyCodeLine{00327\ \ \ \ \ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_PATH\_FORMAT\_INVALID;}
\DoxyCodeLine{00329\ \ \ \ \ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{comment}{/*\ Traverse\ directory\ structure\ starting\ in\ root\ directory\ */}}
\DoxyCodeLine{00332\ \ \ \ \ \mbox{\hyperlink{status_8h_a99cfc2ffa79fcbac77f8df8bea625959}{RETURN\_IF}}(\mbox{\hyperlink{fs_8c_ac279b7defe2d30fb1520889db9f7175d}{disk\_read}}(\mbox{\hyperlink{atfs_8h_abef1527b5f0917d3ca73ac7a60435ae3}{ATFS\_SECTOR\_BOOT}},\ buf));}
\DoxyCodeLine{00333\ \ \ \ \ entry.\mbox{\hyperlink{structDirEntry_a93ca5bc3af57ac8b2cd037b54294f15e}{StartBlock}}\ =\ \mbox{\hyperlink{atfs_8h_a58dff0b38327e2389ba33ca793d2b633}{load\_le\_32}}(buf\ +\ \mbox{\hyperlink{atfs_8h_a2c43a1d72edfe3950bea1899e0fa11d3}{ATFS\_OFFSET\_ROOT\_BLOCK}});}
\DoxyCodeLine{00334\ \ \ \ \ entry.\mbox{\hyperlink{structDirEntry_a462ba4f99a1f85873871da0c17642514}{SizeBlocks}}\ =\ \mbox{\hyperlink{atfs_8h_a58dff0b38327e2389ba33ca793d2b633}{load\_le\_32}}(buf\ +\ \mbox{\hyperlink{atfs_8h_acaaa3f9e7dad1ec7fd869ff474ed09e0}{ATFS\_OFFSET\_ROOT\_SIZE}});}
\DoxyCodeLine{00335\ \ \ \ \ s\ =\ path;}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{while}(*s)}
\DoxyCodeLine{00337\ \ \ \ \ \{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Get\ next\ part\ of\ path\ string\ */}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ name\ =\ s;}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(;\ (c\ =\ *s)\ \&\&\ c\ !=\ \mbox{\hyperlink{atfs_8h_aee9bd507ba70162e1a4a9ae8f53d9ce4}{ATFS\_DIR\_SEPARATOR}};\ ++s)\ \{\}}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ name\_len\ =\ s\ -\/\ name;}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Search\ current\ directory\ */}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{status_8h_a99cfc2ffa79fcbac77f8df8bea625959}{RETURN\_IF}}(\mbox{\hyperlink{fs_8c_a40a308e7f20b463a77c92972ae7be23b}{\_find\_entry}}(name,\ name\_len,\ entry.\mbox{\hyperlink{structDirEntry_a93ca5bc3af57ac8b2cd037b54294f15e}{StartBlock}},\ \&entry));}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ If\ in\ the\ middle\ of\ a\ path\ */}}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!*s)}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Skip\ directory\ separator\ */}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ ++s;}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Found\ entry\ must\ be\ a\ directory\ */}}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(entry.\mbox{\hyperlink{structDirEntry_ab9edbf239fb86e892e318b6ac23bf1a0}{Type}})}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_NO\_SUCH\_FILE\_OR\_DIR;}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00358\ \ \ \ \ \}}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{/*\ Entry\ was\ found\ */}}
\DoxyCodeLine{00361\ \ \ \ \ file-\/>\mbox{\hyperlink{structFile_a199db8ea0b6946f3a83004d2f6af2782}{StartBlock}}\ =\ entry.\mbox{\hyperlink{structDirEntry_a93ca5bc3af57ac8b2cd037b54294f15e}{StartBlock}};}
\DoxyCodeLine{00362\ \ \ \ \ file-\/>\mbox{\hyperlink{structFile_a3142877b4d830066342d6473cc2a84fc}{SizeBlocks}}\ =\ entry.\mbox{\hyperlink{structDirEntry_a462ba4f99a1f85873871da0c17642514}{SizeBlocks}};}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00364\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fs_8c_source_l00081}{\+\_\+find\+\_\+entry()}}, \mbox{\hyperlink{atfs_8h_source_l00024}{ATFS\+\_\+\+BLOCK\+\_\+\+SIZE}}, \mbox{\hyperlink{atfs_8h_source_l00061}{ATFS\+\_\+\+DIR\+\_\+\+SEPARATOR}}, \mbox{\hyperlink{atfs_8h_source_l00050}{ATFS\+\_\+\+OFFSET\+\_\+\+ROOT\+\_\+\+BLOCK}}, \mbox{\hyperlink{atfs_8h_source_l00053}{ATFS\+\_\+\+OFFSET\+\_\+\+ROOT\+\_\+\+SIZE}}, \mbox{\hyperlink{atfs_8h_source_l00027}{ATFS\+\_\+\+SECTOR\+\_\+\+BOOT}}, \mbox{\hyperlink{fs_8c_source_l00035}{disk\+\_\+read()}}, \mbox{\hyperlink{atfs_8h_source_l00115}{load\+\_\+le\+\_\+32()}}, \mbox{\hyperlink{fs_8c_source_l00212}{path\+\_\+valid()}}, \mbox{\hyperlink{status_8h_source_l00029}{RETURN\+\_\+\+IF}}, \mbox{\hyperlink{fs_8h_source_l00023}{File\+::\+Size\+Blocks}}, \mbox{\hyperlink{fs_8h_source_l00050}{Dir\+Entry\+::\+Size\+Blocks}}, \mbox{\hyperlink{fs_8h_source_l00020}{File\+::\+Start\+Block}}, \mbox{\hyperlink{fs_8h_source_l00047}{Dir\+Entry\+::\+Start\+Block}}, and \mbox{\hyperlink{fs_8h_source_l00056}{Dir\+Entry\+::\+Type}}.



Referenced by \mbox{\hyperlink{fs_8c_source_l00411}{fs\+\_\+dopen()}}.

\Hypertarget{fs_8h_aa2157dd7489909ac9b1fd0c5a1e95dd7}\label{fs_8h_aa2157dd7489909ac9b1fd0c5a1e95dd7} 
\index{fs.h@{fs.h}!fs\_format@{fs\_format}}
\index{fs\_format@{fs\_format}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_format()}{fs\_format()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+format (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{disk }\end{DoxyParamCaption})}



Format disk with ATFS. 


\begin{DoxyParams}{Parameters}
{\em disk} & Drive number \\
\hline
\end{DoxyParams}
\Hypertarget{fs_8h_a17bf6e1159e5e88ed4529b80f2091d9a}\label{fs_8h_a17bf6e1159e5e88ed4529b80f2091d9a} 
\index{fs.h@{fs.h}!fs\_fread@{fs\_fread}}
\index{fs\_fread@{fs\_fread}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_fread()}{fs\_fread()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+fread (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structFile}{File}} \texorpdfstring{$\ast$}{*}}]{file,  }\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{block,  }\item[{void \texorpdfstring{$\ast$}{*}}]{buf }\end{DoxyParamCaption})}



Reads one block from the file. 


\begin{DoxyParams}{Parameters}
{\em file} & \doxylink{structFile}{File} handle \\
\hline
{\em block} & The block to read \\
\hline
{\em buf} & Buffer for read data (512 bytes) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00366}{366}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00367\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordflow}{if}(block\ >=\ file-\/>\mbox{\hyperlink{structFile_a3142877b4d830066342d6473cc2a84fc}{SizeBlocks}})}
\DoxyCodeLine{00369\ \ \ \ \ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OUT\_OF\_BOUNDS;}
\DoxyCodeLine{00371\ \ \ \ \ \}}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{fs_8c_ac279b7defe2d30fb1520889db9f7175d}{disk\_read}}(file-\/>\mbox{\hyperlink{structFile_a199db8ea0b6946f3a83004d2f6af2782}{StartBlock}}\ +\ block,\ buf);}
\DoxyCodeLine{00374\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fs_8c_source_l00035}{disk\+\_\+read()}}, \mbox{\hyperlink{fs_8h_source_l00023}{File\+::\+Size\+Blocks}}, and \mbox{\hyperlink{fs_8h_source_l00020}{File\+::\+Start\+Block}}.



Referenced by \mbox{\hyperlink{fs_8c_source_l00411}{fs\+\_\+dopen()}}, and \mbox{\hyperlink{fs_8c_source_l00421}{fs\+\_\+dread()}}.

\Hypertarget{fs_8h_ade85fb2d3dc6e58f8364ac780255732f}\label{fs_8h_ade85fb2d3dc6e58f8364ac780255732f} 
\index{fs.h@{fs.h}!fs\_fwrite@{fs\_fwrite}}
\index{fs\_fwrite@{fs\_fwrite}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_fwrite()}{fs\_fwrite()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+fwrite (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structFile}{File}} \texorpdfstring{$\ast$}{*}}]{file,  }\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{block,  }\item[{const void \texorpdfstring{$\ast$}{*}}]{buf }\end{DoxyParamCaption})}



Write one block to the file. 


\begin{DoxyParams}{Parameters}
{\em file} & \doxylink{structFile}{File} handle \\
\hline
{\em block} & The block to write \\
\hline
{\em buf} & Buffer with data to write (512 bytes) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00376}{376}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00377\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordflow}{if}(block\ >=\ file-\/>\mbox{\hyperlink{structFile_a3142877b4d830066342d6473cc2a84fc}{SizeBlocks}})}
\DoxyCodeLine{00379\ \ \ \ \ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OUT\_OF\_BOUNDS;}
\DoxyCodeLine{00381\ \ \ \ \ \}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{fs_8c_a3d13d8e8b74225c1bc7d8cc4b2831f9b}{disk\_write}}(file-\/>\mbox{\hyperlink{structFile_a199db8ea0b6946f3a83004d2f6af2782}{StartBlock}}\ +\ block,\ buf);}
\DoxyCodeLine{00384\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fs_8c_source_l00049}{disk\+\_\+write()}}, \mbox{\hyperlink{fs_8h_source_l00023}{File\+::\+Size\+Blocks}}, and \mbox{\hyperlink{fs_8h_source_l00020}{File\+::\+Start\+Block}}.

\Hypertarget{fs_8h_a8324edeaa56757f38563177f3a3b6836}\label{fs_8h_a8324edeaa56757f38563177f3a3b6836} 
\index{fs.h@{fs.h}!fs\_mount@{fs\_mount}}
\index{fs\_mount@{fs\_mount}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_mount()}{fs\_mount()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+mount (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{disk,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{ident }\end{DoxyParamCaption})}



Mount disk with ATFS. 


\begin{DoxyParams}{Parameters}
{\em disk} & Drive number \\
\hline
{\em ident} & Identifier \\
\hline
\end{DoxyParams}
\Hypertarget{fs_8h_a9e81e00c6751de4244769f35c74b9aca}\label{fs_8h_a9e81e00c6751de4244769f35c74b9aca} 
\index{fs.h@{fs.h}!fs\_rename@{fs\_rename}}
\index{fs\_rename@{fs\_rename}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{fs\_rename()}{fs\_rename()}}
{\footnotesize\ttfamily \mbox{\hyperlink{status_8h_a67a0db04d321a74b7e7fcfd3f1a3f70b}{Status}} fs\+\_\+rename (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{dest,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{src }\end{DoxyParamCaption})}



Move or rename a file or a directory. 


\begin{DoxyParams}{Parameters}
{\em dest} & Destination path \\
\hline
{\em src} & Source path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Status 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00394}{394}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00395\ \{}
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{comment}{/*\ Create\ new\ directory\ entries\ */}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{comment}{/*\ Delete\ old\ directory\ entries\ */}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{return}\ STATUS\_OK;}
\DoxyCodeLine{00401\ \ \ \ \ (void)dest,\ (\textcolor{keywordtype}{void})src;}
\DoxyCodeLine{00402\ \}}

\end{DoxyCode}
\Hypertarget{fs_8h_a3d7a42239d590a1d9a534002f637ceb7}\label{fs_8h_a3d7a42239d590a1d9a534002f637ceb7} 
\index{fs.h@{fs.h}!identifier\_valid@{identifier\_valid}}
\index{identifier\_valid@{identifier\_valid}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{identifier\_valid()}{identifier\_valid()}}
{\footnotesize\ttfamily bool identifier\+\_\+valid (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path }\end{DoxyParamCaption})}



Check if a identifier is valid. 


\begin{DoxyParams}{Parameters}
{\em ident} & The identifier to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if valid, else false 
\end{DoxyReturn}
\Hypertarget{fs_8h_ae1df2fb5ed0eb11b2636be3207395e17}\label{fs_8h_ae1df2fb5ed0eb11b2636be3207395e17} 
\index{fs.h@{fs.h}!path\_join@{path\_join}}
\index{path\_join@{path\_join}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{path\_join()}{path\_join()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} path\+\_\+join (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{path,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{append }\end{DoxyParamCaption})}



Join two paths by copying the second path to the end of the first path and adding a dot in between. The first string must have enough space to contain the whole path. The validity of the path is not checked. 


\begin{DoxyParams}{Parameters}
{\em path} & First part of the path \\
\hline
{\em append} & Path that should be added to the end of the first path \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
path 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00187}{187}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00188\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}\ len\ =\ \mbox{\hyperlink{string_8c_adbbf4d6ec8d6b708c64bd6a4a18065dd}{strlen}}(path);}
\DoxyCodeLine{00190\ \ \ \ \ path[len]\ =\ \mbox{\hyperlink{atfs_8h_aee9bd507ba70162e1a4a9ae8f53d9ce4}{ATFS\_DIR\_SEPARATOR}};}
\DoxyCodeLine{00191\ \ \ \ \ \mbox{\hyperlink{string_8c_ac5082c8ce4f0cddd88bf4d0d2e738308}{strcpy}}(path\ +\ len\ +\ 1,\ append);}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordflow}{return}\ path;}
\DoxyCodeLine{00193\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{atfs_8h_source_l00061}{ATFS\+\_\+\+DIR\+\_\+\+SEPARATOR}}, \mbox{\hyperlink{string_8c_source_l00011}{strcpy()}}, and \mbox{\hyperlink{string_8c_source_l00029}{strlen()}}.

\Hypertarget{fs_8h_a143f4d56d1fe14d2798428d438ba6d8d}\label{fs_8h_a143f4d56d1fe14d2798428d438ba6d8d} 
\index{fs.h@{fs.h}!path\_parent@{path\_parent}}
\index{path\_parent@{path\_parent}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{path\_parent()}{path\_parent()}}
{\footnotesize\ttfamily char \texorpdfstring{$\ast$}{*} path\+\_\+parent (\begin{DoxyParamCaption}\item[{char \texorpdfstring{$\ast$}{*}}]{path }\end{DoxyParamCaption})}



Remove the last component of the path in place. The validity of the path is not checked. 


\begin{DoxyParams}{Parameters}
{\em path} & The path to remove the last part of \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
path 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00195}{195}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00196\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordtype}{char}\ c,\ *s,\ *last\_sep;}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ last\_sep\ =\ path;}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordflow}{for}(s\ =\ path;\ (c\ =\ *s);\ ++s)}
\DoxyCodeLine{00201\ \ \ \ \ \{}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(c\ ==\ \mbox{\hyperlink{atfs_8h_aee9bd507ba70162e1a4a9ae8f53d9ce4}{ATFS\_DIR\_SEPARATOR}})}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ last\_sep\ =\ s;}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00206\ \ \ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ *last\_sep\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{return}\ path;}
\DoxyCodeLine{00210\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{atfs_8h_source_l00061}{ATFS\+\_\+\+DIR\+\_\+\+SEPARATOR}}.

\Hypertarget{fs_8h_a7d8bf1a0e56adf07abc7792f2667199e}\label{fs_8h_a7d8bf1a0e56adf07abc7792f2667199e} 
\index{fs.h@{fs.h}!path\_valid@{path\_valid}}
\index{path\_valid@{path\_valid}!fs.h@{fs.h}}
\doxysubsubsection{\texorpdfstring{path\_valid()}{path\_valid()}}
{\footnotesize\ttfamily bool path\+\_\+valid (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path }\end{DoxyParamCaption})}



Check if a path is valid. 


\begin{DoxyParams}{Parameters}
{\em path} & The path to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if valid, else false 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{fs_8c_source_l00212}{212}} of file \mbox{\hyperlink{fs_8c_source}{fs.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00213\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordtype}{bool}\ was\_sep;}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordtype}{char}\ c;}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *s;}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ with\ true\ because\ path\ may\ not\ start\ with\ separator\ */}}
\DoxyCodeLine{00219\ \ \ \ \ was\_sep\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{for}(s\ =\ path;\ (c\ =\ *s);\ ++s)}
\DoxyCodeLine{00221\ \ \ \ \ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(c\ ==\ \mbox{\hyperlink{atfs_8h_aee9bd507ba70162e1a4a9ae8f53d9ce4}{ATFS\_DIR\_SEPARATOR}})}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(was\_sep)}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Two\ separators\ in\ a\ row\ are\ not\ allowed\ */}}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ was\_sep\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{ctype_8c_aac8cacb5cd9b960305b7d00c909a8ecd}{isdigit}}(c))}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(was\_sep)}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Path\ component\ may\ not\ start\ with\ a\ digit\ */}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ was\_sep\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(c\ ==\ \textcolor{charliteral}{'\_'}\ ||\ \mbox{\hyperlink{ctype_8c_a6cb0b03ec6677fb97b80c588d29d7421}{islower}}(c))}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ was\_sep\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ Invalid\ character\ */}}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00251\ \ \ \ \ \}}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{comment}{/*\ Path\ may\ not\ end\ with\ separator,\ but\ allow\ empty\ path\ */}}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{return}\ !was\_sep\ ||\ *path\ ==\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00255\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{atfs_8h_source_l00061}{ATFS\+\_\+\+DIR\+\_\+\+SEPARATOR}}, \mbox{\hyperlink{ctype_8c_source_l00026}{isdigit()}}, and \mbox{\hyperlink{ctype_8c_source_l00036}{islower()}}.



Referenced by \mbox{\hyperlink{fs_8c_source_l00317}{fs\+\_\+fopen()}}.

