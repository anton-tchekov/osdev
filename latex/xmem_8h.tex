\hypertarget{xmem_8h}{}\doxysection{platform/avr/xmem/xmem.h File Reference}
\label{xmem_8h}\index{platform/avr/xmem/xmem.h@{platform/avr/xmem/xmem.h}}


External memory driver (23LC1024)  


{\ttfamily \#include $<$types.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{xmem_8h_aa98b163510e84b9e79394397efdb8dde}{xmem\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initialize external memory and run memory test. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{xmem_8h_ac439854f5a1e0bd1b2f52c1028fc900a}{xmem\+\_\+read}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, void $\ast$data, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\begin{DoxyCompactList}\small\item\em Read the specified number of bytes from the external memory. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{xmem_8h_afef9c92490450d98f177f53f2b174f20}{xmem\+\_\+write}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, const void $\ast$data, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\begin{DoxyCompactList}\small\item\em Write the specified number of bytes to the external memory. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{xmem_8h_ab820b468ff9c382227cb704e6935a986}{xmem\+\_\+set}} (\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} addr, \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}} value, \mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}} size)
\begin{DoxyCompactList}\small\item\em Set a specified number of bytes in the external memory to a value. \end{DoxyCompactList}\item 
\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \mbox{\hyperlink{xmem_8h_a4164d03f7168bc7c7d3ce75d27bc6547}{xmem\+\_\+size}} (void)
\begin{DoxyCompactList}\small\item\em Get external memory size. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
External memory driver (23LC1024) 

\begin{DoxyAuthor}{Author}
Tim Gabrikowski, Anton Tchekov 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
01.\+05.\+2023 
\end{DoxyDate}


Definition in file \mbox{\hyperlink{xmem_8h_source}{xmem.\+h}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{xmem_8h_aa98b163510e84b9e79394397efdb8dde}\label{xmem_8h_aa98b163510e84b9e79394397efdb8dde}} 
\index{xmem.h@{xmem.h}!xmem\_init@{xmem\_init}}
\index{xmem\_init@{xmem\_init}!xmem.h@{xmem.h}}
\doxysubsubsection{\texorpdfstring{xmem\_init()}{xmem\_init()}}
{\footnotesize\ttfamily void xmem\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize external memory and run memory test. 



Definition at line \mbox{\hyperlink{xmem_8c_source_l00225}{225}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00226\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ XMEM\ */}}
\DoxyCodeLine{00228\ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}External\ memory\ driver\ initialized"{}}));}
\DoxyCodeLine{00229\ \ \ \ \ \_memtest();}
\DoxyCodeLine{00230\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{logger_8c_source_l00164}{log\+\_\+boot\+\_\+\+P()}}.

\mbox{\Hypertarget{xmem_8h_ac439854f5a1e0bd1b2f52c1028fc900a}\label{xmem_8h_ac439854f5a1e0bd1b2f52c1028fc900a}} 
\index{xmem.h@{xmem.h}!xmem\_read@{xmem\_read}}
\index{xmem\_read@{xmem\_read}!xmem.h@{xmem.h}}
\doxysubsubsection{\texorpdfstring{xmem\_read()}{xmem\_read()}}
{\footnotesize\ttfamily void xmem\+\_\+read (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{void $\ast$}]{data,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})}



Read the specified number of bytes from the external memory. 


\begin{DoxyParams}{Parameters}
{\em addr} & Start address \\
\hline
{\em data} & Destination buffer \\
\hline
{\em size} & Number of bytes to read \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00232}{232}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00233\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \mbox{\hyperlink{structAddrHelper}{AddrHelper}}\ h;}
\DoxyCodeLine{00235\ \ \ \ \ \_xmem\_overlap(addr,\ size,\ \&h);}
\DoxyCodeLine{00236\ \ \ \ \ \_xmem\_read(h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}},\ h.\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}},\ data,\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}});}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{if}(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ !=\ h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}})}
\DoxyCodeLine{00238\ \ \ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \_xmem\_read(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}},\ 0,\ (\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ *)data\ +\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}},\ h.\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}});}
\DoxyCodeLine{00240\ \ \ \ \ \}}
\DoxyCodeLine{00241\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00195}{Addr\+Helper\+::\+Addr\+First}}, \mbox{\hyperlink{xmem_8c_source_l00189}{Addr\+Helper\+::\+Bank\+First}}, \mbox{\hyperlink{xmem_8c_source_l00192}{Addr\+Helper\+::\+Bank\+Second}}, \mbox{\hyperlink{xmem_8c_source_l00198}{Addr\+Helper\+::\+Size\+First}}, and \mbox{\hyperlink{xmem_8c_source_l00201}{Addr\+Helper\+::\+Size\+Second}}.



Referenced by \mbox{\hyperlink{avr_2platform_8c_source_l00024}{env\+\_\+memory\+\_\+read()}}, and \mbox{\hyperlink{lcd_8c_source_l00506}{lcd\+\_\+image\+\_\+1bit()}}.

\mbox{\Hypertarget{xmem_8h_ab820b468ff9c382227cb704e6935a986}\label{xmem_8h_ab820b468ff9c382227cb704e6935a986}} 
\index{xmem.h@{xmem.h}!xmem\_set@{xmem\_set}}
\index{xmem\_set@{xmem\_set}!xmem.h@{xmem.h}}
\doxysubsubsection{\texorpdfstring{xmem\_set()}{xmem\_set()}}
{\footnotesize\ttfamily void xmem\+\_\+set (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{\mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}}]{value,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})}



Set a specified number of bytes in the external memory to a value. 


\begin{DoxyParams}{Parameters}
{\em addr} & Start address \\
\hline
{\em value} & The value to write \\
\hline
{\em size} & Number of bytes to set \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00255}{255}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00256\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \mbox{\hyperlink{structAddrHelper}{AddrHelper}}\ h;}
\DoxyCodeLine{00258\ \ \ \ \ \_xmem\_overlap(addr,\ size,\ \&h);}
\DoxyCodeLine{00259\ \ \ \ \ \_xmem\_set(h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}},\ h.\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}},\ value,\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}});}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordflow}{if}(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ !=\ h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}})}
\DoxyCodeLine{00261\ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \_xmem\_set(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}},\ 0,\ value,\ h.\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}});}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00195}{Addr\+Helper\+::\+Addr\+First}}, \mbox{\hyperlink{xmem_8c_source_l00189}{Addr\+Helper\+::\+Bank\+First}}, \mbox{\hyperlink{xmem_8c_source_l00192}{Addr\+Helper\+::\+Bank\+Second}}, \mbox{\hyperlink{xmem_8c_source_l00198}{Addr\+Helper\+::\+Size\+First}}, and \mbox{\hyperlink{xmem_8c_source_l00201}{Addr\+Helper\+::\+Size\+Second}}.

\mbox{\Hypertarget{xmem_8h_a4164d03f7168bc7c7d3ce75d27bc6547}\label{xmem_8h_a4164d03f7168bc7c7d3ce75d27bc6547}} 
\index{xmem.h@{xmem.h}!xmem\_size@{xmem\_size}}
\index{xmem\_size@{xmem\_size}!xmem.h@{xmem.h}}
\doxysubsubsection{\texorpdfstring{xmem\_size()}{xmem\_size()}}
{\footnotesize\ttfamily \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} xmem\+\_\+size (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Get external memory size. 

\begin{DoxyReturn}{Returns}
Size of the external memory in bytes 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00266}{266}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00267\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{xmem_8c_a41e71a45e1fd04415bc24952cbf50c9b}{BANK\_COUNT}}\ *\ \mbox{\hyperlink{xmem_8c_acb7dc5a33a5b4a8d2b71e744832f9523}{BANK\_SIZE}};}
\DoxyCodeLine{00269\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00021}{BANK\+\_\+\+COUNT}}, and \mbox{\hyperlink{xmem_8c_source_l00027}{BANK\+\_\+\+SIZE}}.



Referenced by \mbox{\hyperlink{avr_2platform_8c_source_l00019}{env\+\_\+memory\+\_\+size()}}.

\mbox{\Hypertarget{xmem_8h_afef9c92490450d98f177f53f2b174f20}\label{xmem_8h_afef9c92490450d98f177f53f2b174f20}} 
\index{xmem.h@{xmem.h}!xmem\_write@{xmem\_write}}
\index{xmem\_write@{xmem\_write}!xmem.h@{xmem.h}}
\doxysubsubsection{\texorpdfstring{xmem\_write()}{xmem\_write()}}
{\footnotesize\ttfamily void xmem\+\_\+write (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}}}]{addr,  }\item[{const void $\ast$}]{data,  }\item[{\mbox{\hyperlink{types_8h_ace9d960e74685e2cd84b36132dbbf8aa}{u16}}}]{size }\end{DoxyParamCaption})}



Write the specified number of bytes to the external memory. 


\begin{DoxyParams}{Parameters}
{\em addr} & Start address \\
\hline
{\em data} & Source buffer \\
\hline
{\em size} & Number of bytes to write \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{xmem_8c_source_l00243}{243}} of file \mbox{\hyperlink{xmem_8c_source}{xmem.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00244\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \mbox{\hyperlink{structAddrHelper}{AddrHelper}}\ h;}
\DoxyCodeLine{00246\ \ \ \ \ \_xmem\_overlap(addr,\ size,\ \&h);}
\DoxyCodeLine{00247\ \ \ \ \ \_xmem\_write(h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}},\ h.\mbox{\hyperlink{structAddrHelper_a48959a2ce13a5e81e9b83f62e5501a24}{AddrFirst}},\ data,\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}});}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keywordflow}{if}(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}}\ !=\ h.\mbox{\hyperlink{structAddrHelper_a7597aa93dc6a712b7ac697879ef3768d}{BankFirst}})}
\DoxyCodeLine{00249\ \ \ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \_xmem\_write(h.\mbox{\hyperlink{structAddrHelper_a55785530f6ea3f15b72cfc755f843a54}{BankSecond}},\ 0,\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{types_8h_a92c50087ca0e64fa93fc59402c55f8ca}{u8}}\ *)data\ +\ h.\mbox{\hyperlink{structAddrHelper_af38568f8537f8a534bf45ee365d918ac}{SizeFirst}},}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ h.\mbox{\hyperlink{structAddrHelper_ad4ce4c26acb9bd7878abb60416288fe5}{SizeSecond}});}
\DoxyCodeLine{00252\ \ \ \ \ \}}
\DoxyCodeLine{00253\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{xmem_8c_source_l00195}{Addr\+Helper\+::\+Addr\+First}}, \mbox{\hyperlink{xmem_8c_source_l00189}{Addr\+Helper\+::\+Bank\+First}}, \mbox{\hyperlink{xmem_8c_source_l00192}{Addr\+Helper\+::\+Bank\+Second}}, \mbox{\hyperlink{xmem_8c_source_l00198}{Addr\+Helper\+::\+Size\+First}}, and \mbox{\hyperlink{xmem_8c_source_l00201}{Addr\+Helper\+::\+Size\+Second}}.



Referenced by \mbox{\hyperlink{avr_2platform_8c_source_l00029}{env\+\_\+memory\+\_\+write()}}, and \mbox{\hyperlink{initrd_8c_source_l00027}{initrd\+\_\+load()}}.

