\doxysection{platform/avr/timer/timer.c File Reference}
\hypertarget{timer_8c}{}\label{timer_8c}\index{platform/avr/timer/timer.c@{platform/avr/timer/timer.c}}
{\ttfamily \#include $<$timer.\+h$>$}\newline
{\ttfamily \#include $<$serial.\+h$>$}\newline
{\ttfamily \#include $<$logger.\+h$>$}\newline
{\ttfamily \#include $<$avr/interrupt.\+h$>$}\newline
{\ttfamily \#include $<$avr/pgmspace.\+h$>$}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{timer_8c_a7b8ab79df77b57475a5494f5f81c3bd9}{timer\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em Initialize hardware timer/counter. \end{DoxyCompactList}\item 
\mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \mbox{\hyperlink{timer_8c_aee701eeb891b748ed2e12da119816882}{millis}} (void)
\begin{DoxyCompactList}\small\item\em Get milliseconds since startup. \end{DoxyCompactList}\item 
\mbox{\hyperlink{timer_8c_aec43762dc86e029b395d4e5819192c2d}{ISR}} (TIMER0\+\_\+\+COMPA\+\_\+vect)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static volatile \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \mbox{\hyperlink{timer_8c_a4876578a604b8a6b327e06515ca68bfd}{\+\_\+ms}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Tim Gabrikowski, Anton Tchekov 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
01.\+05.\+2023 
\end{DoxyDate}


Definition in file \mbox{\hyperlink{timer_8c_source}{timer.\+c}}.



\doxysubsection{Function Documentation}
\Hypertarget{timer_8c_aec43762dc86e029b395d4e5819192c2d}\label{timer_8c_aec43762dc86e029b395d4e5819192c2d} 
\index{timer.c@{timer.c}!ISR@{ISR}}
\index{ISR@{ISR}!timer.c@{timer.c}}
\doxysubsubsection{\texorpdfstring{ISR()}{ISR()}}
{\footnotesize\ttfamily ISR (\begin{DoxyParamCaption}\item[{TIMER0\+\_\+\+COMPA\+\_\+vect}]{ }\end{DoxyParamCaption})}

Timer0 compare interrupt 

Definition at line \mbox{\hyperlink{timer_8c_source_l00043}{43}} of file \mbox{\hyperlink{timer_8c_source}{timer.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00044\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{/*\ Increment\ overflows\ after\ approx.\ 50\ days\ */}}
\DoxyCodeLine{00046\ \ \ \ \ ++\mbox{\hyperlink{timer_8c_a4876578a604b8a6b327e06515ca68bfd}{\_ms}};}
\DoxyCodeLine{00047\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{timer_8c_source_l00015}{\+\_\+ms}}.

\Hypertarget{timer_8c_aee701eeb891b748ed2e12da119816882}\label{timer_8c_aee701eeb891b748ed2e12da119816882} 
\index{timer.c@{timer.c}!millis@{millis}}
\index{millis@{millis}!timer.c@{timer.c}}
\doxysubsubsection{\texorpdfstring{millis()}{millis()}}
{\footnotesize\ttfamily \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} millis (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Get milliseconds since startup. 

Gets the number of milliseconds since startup.

\begin{DoxyReturn}{Returns}
Number of milliseconds 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{timer_8c_source_l00036}{36}} of file \mbox{\hyperlink{timer_8c_source}{timer.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{/*\ Return\ number\ of\ milliseconds\ since\ boot\ */}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{timer_8c_a4876578a604b8a6b327e06515ca68bfd}{\_ms}};}
\DoxyCodeLine{00040\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{timer_8c_source_l00015}{\+\_\+ms}}.



Referenced by \mbox{\hyperlink{apps_2init_2main_8c_source_l00109}{\+\_\+show\+\_\+error()}}, \mbox{\hyperlink{avr_2platform_8c_source_l00137}{env\+\_\+millis()}}, and \mbox{\hyperlink{apps_2init_2main_8c_source_l00241}{loop()}}.

\Hypertarget{timer_8c_a7b8ab79df77b57475a5494f5f81c3bd9}\label{timer_8c_a7b8ab79df77b57475a5494f5f81c3bd9} 
\index{timer.c@{timer.c}!timer\_init@{timer\_init}}
\index{timer\_init@{timer\_init}!timer.c@{timer.c}}
\doxysubsubsection{\texorpdfstring{timer\_init()}{timer\_init()}}
{\footnotesize\ttfamily void timer\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initialize hardware timer/counter. 



Definition at line \mbox{\hyperlink{timer_8c_source_l00017}{17}} of file \mbox{\hyperlink{timer_8c_source}{timer.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00018\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ hardware\ timers\ */}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{comment}{/*\ CTC\ Mode\ */}}
\DoxyCodeLine{00022\ \ \ \ \ TCCR0A\ =\ (1\ <<\ WGM01);}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{/*\ Prescaler\ 64\ */}}
\DoxyCodeLine{00025\ \ \ \ \ TCCR0B\ |=\ (1\ <<\ CS01)\ |\ (1\ <<\ CS00);}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{/*\ 16000000\ /\ 64\ /\ 1000\ =\ 250\ */}}
\DoxyCodeLine{00028\ \ \ \ \ OCR0A\ =\ 250\ -\/\ 1;}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{/*\ Enable\ compare\ interrupt\ */}}
\DoxyCodeLine{00031\ \ \ \ \ TIMSK0\ |=\ (1\ <<\ OCIE0A);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{logger_8c_a60bd636ef160c97eb51cf31be5954ba2}{log\_boot\_P}}(LOG\_INIT,\ PSTR(\textcolor{stringliteral}{"{}Millisecond\ timer\ initialized"{}}));}
\DoxyCodeLine{00034\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{logger_8c_source_l00170}{log\+\_\+boot\+\_\+\+P()}}.



Referenced by \mbox{\hyperlink{platform_2avr_2main_8c_source_l00029}{main()}}.



\doxysubsection{Variable Documentation}
\Hypertarget{timer_8c_a4876578a604b8a6b327e06515ca68bfd}\label{timer_8c_a4876578a604b8a6b327e06515ca68bfd} 
\index{timer.c@{timer.c}!\_ms@{\_ms}}
\index{\_ms@{\_ms}!timer.c@{timer.c}}
\doxysubsubsection{\texorpdfstring{\_ms}{\_ms}}
{\footnotesize\ttfamily volatile \mbox{\hyperlink{types_8h_afaa62991928fb9fb18ff0db62a040aba}{u32}} \+\_\+ms\hspace{0.3cm}{\ttfamily [static]}}

Millisecond counter 

Definition at line \mbox{\hyperlink{timer_8c_source_l00015}{15}} of file \mbox{\hyperlink{timer_8c_source}{timer.\+c}}.



Referenced by \mbox{\hyperlink{timer_8c_source_l00043}{ISR()}}, and \mbox{\hyperlink{timer_8c_source_l00036}{millis()}}.

