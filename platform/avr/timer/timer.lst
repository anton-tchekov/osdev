   1               		.file	"timer.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.file 0 "/home/files/osdev/platform/avr" "timer/timer.c"
  11               	.global	timer_init
  13               	timer_init:
  14               	.LFB3:
  15               		.file 1 "timer/timer.c"
   1:timer/timer.c **** /**
   2:timer/timer.c ****  * @file    timer.c
   3:timer/timer.c ****  * @author  Tim Gabrikowski, Anton Tchekov
   4:timer/timer.c ****  * @version 0.1
   5:timer/timer.c ****  * @date    01.05.2023
   6:timer/timer.c ****  */
   7:timer/timer.c **** 
   8:timer/timer.c **** #include <timer.h>
   9:timer/timer.c **** #include <serial.h>
  10:timer/timer.c **** #include <logger.h>
  11:timer/timer.c **** #include <avr/interrupt.h>
  12:timer/timer.c **** #include <avr/pgmspace.h>
  13:timer/timer.c **** 
  14:timer/timer.c **** static volatile u32 _ms;
  15:timer/timer.c **** 
  16:timer/timer.c **** void timer_init(void)
  17:timer/timer.c **** {
  16               		.loc 1 17 1 view -0
  17               		.cfi_startproc
  18               	/* prologue: function */
  19               	/* frame size = 0 */
  20               	/* stack size = 0 */
  21               	.L__stack_usage = 0
  18:timer/timer.c **** 	/* Initialize hardware timers */
  19:timer/timer.c **** 
  20:timer/timer.c **** 	/* CTC Mode */
  21:timer/timer.c **** 	TCCR0A = (1 << WGM01);
  22               		.loc 1 21 2 view .LVU1
  23               		.loc 1 21 9 is_stmt 0 view .LVU2
  24 0000 82E0      		ldi r24,lo8(2)
  25 0002 84BD      		out 0x24,r24
  22:timer/timer.c **** 
  23:timer/timer.c **** 	/* Prescaler 64 */
  24:timer/timer.c **** 	TCCR0B |= (1 << CS01) | (1 << CS00);
  26               		.loc 1 24 2 is_stmt 1 view .LVU3
  27 0004 85B5      		in r24,0x25
  28               		.loc 1 24 9 is_stmt 0 view .LVU4
  29 0006 8360      		ori r24,lo8(3)
  30 0008 85BD      		out 0x25,r24
  25:timer/timer.c **** 
  26:timer/timer.c **** 	/* 16000000 / 64 / 1000 = 250 */
  27:timer/timer.c **** 	OCR0A = 250 - 1;
  31               		.loc 1 27 2 is_stmt 1 view .LVU5
  32               		.loc 1 27 8 is_stmt 0 view .LVU6
  33 000a 89EF      		ldi r24,lo8(-7)
  34 000c 87BD      		out 0x27,r24
  28:timer/timer.c **** 
  29:timer/timer.c **** 	/* Enable compare interrupt */
  30:timer/timer.c **** 	TIMSK0 |= (1 << OCIE0A);
  35               		.loc 1 30 2 is_stmt 1 view .LVU7
  36 000e EEE6      		ldi r30,lo8(110)
  37 0010 F0E0      		ldi r31,0
  38 0012 8081      		ld r24,Z
  39               		.loc 1 30 9 is_stmt 0 view .LVU8
  40 0014 8260      		ori r24,lo8(2)
  41 0016 8083      		st Z,r24
  31:timer/timer.c **** 
  32:timer/timer.c **** 	log_boot_P(PSTR("Millisecond timer initialized"));
  42               		.loc 1 32 2 is_stmt 1 view .LVU9
  43               	.LBB2:
  44               		.loc 1 32 13 view .LVU10
  45               		.loc 1 32 13 view .LVU11
  46               	.LBE2:
  47               		.loc 1 32 2 is_stmt 0 view .LVU12
  48 0018 80E0      		ldi r24,lo8(__c.0)
  49 001a 90E0      		ldi r25,hi8(__c.0)
  50 001c 9F93      		push r25
  51               		.cfi_def_cfa_offset 3
  52 001e 8F93      		push r24
  53               		.cfi_def_cfa_offset 4
  54 0020 0E94 0000 		call log_boot_P
  55               	.LVL0:
  33:timer/timer.c **** }
  56               		.loc 1 33 1 view .LVU13
  57 0024 0F90      		pop __tmp_reg__
  58 0026 0F90      		pop __tmp_reg__
  59               		.cfi_def_cfa_offset 2
  60               	/* epilogue start */
  61 0028 0895      		ret
  62               		.cfi_endproc
  63               	.LFE3:
  65               	.global	millis
  67               	millis:
  68               	.LFB4:
  34:timer/timer.c **** 
  35:timer/timer.c **** u32 millis(void)
  36:timer/timer.c **** {
  69               		.loc 1 36 1 is_stmt 1 view -0
  70               		.cfi_startproc
  71 002a CF93      		push r28
  72               		.cfi_def_cfa_offset 3
  73               		.cfi_offset 28, -2
  74 002c DF93      		push r29
  75               		.cfi_def_cfa_offset 4
  76               		.cfi_offset 29, -3
  77 002e 00D0      		rcall .
  78 0030 00D0      		rcall .
  79               		.cfi_def_cfa_offset 8
  80 0032 CDB7      		in r28,__SP_L__
  81 0034 DEB7      		in r29,__SP_H__
  82               		.cfi_def_cfa_register 28
  83               	/* prologue: function */
  84               	/* frame size = 4 */
  85               	/* stack size = 6 */
  86               	.L__stack_usage = 6
  37:timer/timer.c **** 	/* Return number of milliseconds since boot */
  38:timer/timer.c **** 	return _ms;
  87               		.loc 1 38 2 view .LVU15
  88               		.loc 1 38 9 is_stmt 0 view .LVU16
  89 0036 8091 0000 		lds r24,_ms
  90 003a 9091 0000 		lds r25,_ms+1
  91 003e A091 0000 		lds r26,_ms+2
  92 0042 B091 0000 		lds r27,_ms+3
  39:timer/timer.c **** }
  93               		.loc 1 39 1 view .LVU17
  94 0046 BC01      		movw r22,r24
  95 0048 CD01      		movw r24,r26
  96               	/* epilogue start */
  97 004a 0F90      		pop __tmp_reg__
  98 004c 0F90      		pop __tmp_reg__
  99 004e 0F90      		pop __tmp_reg__
 100 0050 0F90      		pop __tmp_reg__
 101 0052 DF91      		pop r29
 102 0054 CF91      		pop r28
 103 0056 0895      		ret
 104               		.cfi_endproc
 105               	.LFE4:
 107               	.global	__vector_14
 109               	__vector_14:
 110               	.LFB5:
  40:timer/timer.c **** 
  41:timer/timer.c **** /* Timer0 compare interrupt */
  42:timer/timer.c **** ISR(TIMER0_COMPA_vect)
  43:timer/timer.c **** {
 111               		.loc 1 43 1 is_stmt 1 view -0
 112               		.cfi_startproc
 113 0058 1F92 1FB6 		__gcc_isr 1
 113      1F92 1124 
 113      8F93 
 114 0062 9F93      		push r25
 115               		.cfi_def_cfa_offset 3
 116               		.cfi_offset 25, -2
 117 0064 AF93      		push r26
 118               		.cfi_def_cfa_offset 4
 119               		.cfi_offset 26, -3
 120 0066 BF93      		push r27
 121               		.cfi_def_cfa_offset 5
 122               		.cfi_offset 27, -4
 123               	/* prologue: Signal */
 124               	/* frame size = 0 */
 125               	/* stack size = 3...7 */
 126               	.L__stack_usage = 3 + __gcc_isr.n_pushed
  44:timer/timer.c **** 	/* Increment overflows after approx. 50 days */
  45:timer/timer.c **** 	++_ms;
 127               		.loc 1 45 2 view .LVU19
 128 0068 8091 0000 		lds r24,_ms
 129 006c 9091 0000 		lds r25,_ms+1
 130 0070 A091 0000 		lds r26,_ms+2
 131 0074 B091 0000 		lds r27,_ms+3
 132 0078 0196      		adiw r24,1
 133 007a A11D      		adc r26,__zero_reg__
 134 007c B11D      		adc r27,__zero_reg__
 135 007e 8093 0000 		sts _ms,r24
 136 0082 9093 0000 		sts _ms+1,r25
 137 0086 A093 0000 		sts _ms+2,r26
 138 008a B093 0000 		sts _ms+3,r27
 139               	/* epilogue start */
  46:timer/timer.c **** }
 140               		.loc 1 46 1 is_stmt 0 view .LVU20
 141 008e BF91      		pop r27
 142 0090 AF91      		pop r26
 143 0092 9F91      		pop r25
 144 0094 8F91 1F90 		__gcc_isr 2
 144      1FBE 1F90 
 145 009c 1895      		reti
 146               		__gcc_isr 0,r24
 147               		.cfi_endproc
 148               	.LFE5:
 150               		.section	.progmem.data,"a",@progbits
 153               	__c.0:
 154 0000 4D69 6C6C 		.string	"Millisecond timer initialized"
 154      6973 6563 
 154      6F6E 6420 
 154      7469 6D65 
 154      7220 696E 
 155               		.local	_ms
 156               		.comm	_ms,4,1
 157               		.text
 158               	.Letext0:
 159               		.file 2 "/usr/lib/gcc/avr/12.2.0/include/stdint-gcc.h"
 160               		.file 3 "../../types/types.h"
 161               		.file 4 "logger/logger.h"
DEFINED SYMBOLS
                            *ABS*:00000000 timer.c
     /tmp/ccQghYBb.s:2      *ABS*:0000003e __SP_H__
     /tmp/ccQghYBb.s:3      *ABS*:0000003d __SP_L__
     /tmp/ccQghYBb.s:4      *ABS*:0000003f __SREG__
     /tmp/ccQghYBb.s:5      *ABS*:00000000 __tmp_reg__
     /tmp/ccQghYBb.s:6      *ABS*:00000001 __zero_reg__
     /tmp/ccQghYBb.s:13     .text:00000000 timer_init
     /tmp/ccQghYBb.s:16     .text:00000000 .Loc.0
     /tmp/ccQghYBb.s:17     .text:00000000 L0
     /tmp/ccQghYBb.s:22     .text:00000000 .Loc.1
     /tmp/ccQghYBb.s:23     .text:00000000 .Loc.2
     /tmp/ccQghYBb.s:26     .text:00000004 .Loc.3
     /tmp/ccQghYBb.s:28     .text:00000006 .Loc.4
     /tmp/ccQghYBb.s:31     .text:0000000a .Loc.5
     /tmp/ccQghYBb.s:32     .text:0000000a .Loc.6
     /tmp/ccQghYBb.s:35     .text:0000000e .Loc.7
     /tmp/ccQghYBb.s:39     .text:00000014 .Loc.8
     /tmp/ccQghYBb.s:42     .text:00000018 .Loc.9
     /tmp/ccQghYBb.s:44     .text:00000018 .Loc.10
     /tmp/ccQghYBb.s:45     .text:00000018 .Loc.11
     /tmp/ccQghYBb.s:47     .text:00000018 .Loc.12
     /tmp/ccQghYBb.s:153    .progmem.data:00000000 __c.0
     /tmp/ccQghYBb.s:56     .text:00000024 .Loc.13
     /tmp/ccQghYBb.s:62     .text:0000002a L0
     /tmp/ccQghYBb.s:67     .text:0000002a millis
     /tmp/ccQghYBb.s:69     .text:0000002a .Loc.14
     /tmp/ccQghYBb.s:70     .text:0000002a L0
     /tmp/ccQghYBb.s:77     .text:00000030 L0
     /tmp/ccQghYBb.s:78     .text:00000032 L0
     /tmp/ccQghYBb.s:87     .text:00000036 .Loc.15
     /tmp/ccQghYBb.s:88     .text:00000036 .Loc.16
                             .bss:00000000 _ms
     /tmp/ccQghYBb.s:93     .text:00000046 .Loc.17
     /tmp/ccQghYBb.s:104    .text:00000058 L0
     /tmp/ccQghYBb.s:109    .text:00000058 __vector_14
     /tmp/ccQghYBb.s:111    .text:00000058 .Loc.18
     /tmp/ccQghYBb.s:112    .text:00000058 L0
                            *ABS*:00000003 __gcc_isr.n_pushed.001
     /tmp/ccQghYBb.s:127    .text:00000068 .Loc.19
     /tmp/ccQghYBb.s:140    .text:0000008e .Loc.20
     /tmp/ccQghYBb.s:147    .text:0000009e L0
     /tmp/ccQghYBb.s:162    .text:0000009e L0
                     .debug_frame:00000000 L0
     /tmp/ccQghYBb.s:319    .debug_abbrev:00000000 .Ldebug_abbrev0
     /tmp/ccQghYBb.s:8      .text:00000000 .Ltext0
     /tmp/ccQghYBb.s:158    .text:0000009e .Letext0
     /tmp/ccQghYBb.s:597    .debug_line:00000000 .Ldebug_line0
     /tmp/ccQghYBb.s:110    .text:00000058 .LFB5
     /tmp/ccQghYBb.s:148    .text:0000009e .LFE5
     /tmp/ccQghYBb.s:68     .text:0000002a .LFB4
     /tmp/ccQghYBb.s:105    .text:00000058 .LFE4
     /tmp/ccQghYBb.s:14     .text:00000000 .LFB3
     /tmp/ccQghYBb.s:63     .text:0000002a .LFE3
     /tmp/ccQghYBb.s:43     .text:00000018 .LBB2
     /tmp/ccQghYBb.s:46     .text:00000018 .LBE2
     /tmp/ccQghYBb.s:55     .text:00000024 .LVL0
     /tmp/ccQghYBb.s:163    .debug_info:00000000 .Ldebug_info0

UNDEFINED SYMBOLS
log_boot_P
__do_clear_bss
