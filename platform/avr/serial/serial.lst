   1               		.file	"serial.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.file 0 "/home/files/osdev/platform/avr" "serial/serial.c"
  11               	.global	serial_init
  13               	serial_init:
  14               	.LFB1:
  15               		.file 1 "serial/serial.c"
   1:serial/serial.c **** /**
   2:serial/serial.c ****  * @file    serial.c
   3:serial/serial.c ****  * @author  Anton Tchekov
   4:serial/serial.c ****  * @version 0.1
   5:serial/serial.c ****  * @date    16.05.2023
   6:serial/serial.c ****  */
   7:serial/serial.c **** 
   8:serial/serial.c **** #include "serial.h"
   9:serial/serial.c **** #include <avr/io.h>
  10:serial/serial.c **** #include <avr/interrupt.h>
  11:serial/serial.c **** #include <avr/pgmspace.h>
  12:serial/serial.c **** 
  13:serial/serial.c **** #define UART_BAUD        9600
  14:serial/serial.c **** #define _BAUD                (((F_CPU / (UART_BAUD * 16UL))) - 1)
  15:serial/serial.c **** 
  16:serial/serial.c **** void serial_init(void)
  17:serial/serial.c **** {
  16               		.loc 1 17 1 view -0
  17               		.cfi_startproc
  18               	/* prologue: function */
  19               	/* frame size = 0 */
  20               	/* stack size = 0 */
  21               	.L__stack_usage = 0
  18:serial/serial.c **** 	UCSR0B = (1 << RXEN0) | (1 << TXEN0);
  22               		.loc 1 18 2 view .LVU1
  23               		.loc 1 18 9 is_stmt 0 view .LVU2
  24 0000 88E1      		ldi r24,lo8(24)
  25 0002 8093 C100 		sts 193,r24
  19:serial/serial.c **** 	UCSR0C = (1 << UCSZ01) | (1 << UCSZ00);
  26               		.loc 1 19 2 is_stmt 1 view .LVU3
  27               		.loc 1 19 9 is_stmt 0 view .LVU4
  28 0006 86E0      		ldi r24,lo8(6)
  29 0008 8093 C200 		sts 194,r24
  20:serial/serial.c **** 	UBRR0 = _BAUD;
  30               		.loc 1 20 2 is_stmt 1 view .LVU5
  31               		.loc 1 20 8 is_stmt 0 view .LVU6
  32 000c 87E6      		ldi r24,lo8(103)
  33 000e 90E0      		ldi r25,0
  34 0010 9093 C500 		sts 196+1,r25
  35 0014 8093 C400 		sts 196,r24
  36               	/* epilogue start */
  21:serial/serial.c **** }
  37               		.loc 1 21 1 view .LVU7
  38 0018 0895      		ret
  39               		.cfi_endproc
  40               	.LFE1:
  42               	.global	serial_tx
  44               	serial_tx:
  45               	.LFB2:
  22:serial/serial.c **** 
  23:serial/serial.c **** void serial_tx(char c)
  24:serial/serial.c **** {
  46               		.loc 1 24 1 is_stmt 1 view -0
  47               		.cfi_startproc
  48               	/* prologue: function */
  49               	/* frame size = 0 */
  50               	/* stack size = 0 */
  51               	.L__stack_usage = 0
  52               	.LVL0:
  53               	.L3:
  25:serial/serial.c **** 	/* TODO: Use interrupts and output buffer */
  26:serial/serial.c **** 	while(!(UCSR0A & (1 << UDRE0))) {}
  54               		.loc 1 26 35 discriminator 1 view .LVU9
  55               		.loc 1 26 8 discriminator 1 view .LVU10
  56               		.loc 1 26 10 is_stmt 0 discriminator 1 view .LVU11
  57 001a 9091 C000 		lds r25,192
  58               		.loc 1 26 8 discriminator 1 view .LVU12
  59 001e 95FF      		sbrs r25,5
  60 0020 00C0      		rjmp .L3
  27:serial/serial.c **** 	UDR0 = c;
  61               		.loc 1 27 2 is_stmt 1 view .LVU13
  62               		.loc 1 27 7 is_stmt 0 view .LVU14
  63 0022 8093 C600 		sts 198,r24
  64               	/* epilogue start */
  28:serial/serial.c **** }
  65               		.loc 1 28 1 view .LVU15
  66 0026 0895      		ret
  67               		.cfi_endproc
  68               	.LFE2:
  70               	.global	serial_tx_str
  72               	serial_tx_str:
  73               	.LVL1:
  74               	.LFB3:
  29:serial/serial.c **** 
  30:serial/serial.c **** void serial_tx_str(const char *s)
  31:serial/serial.c **** {
  75               		.loc 1 31 1 is_stmt 1 view -0
  76               		.cfi_startproc
  77               		.loc 1 31 1 is_stmt 0 view .LVU17
  78 0028 CF93      		push r28
  79               		.cfi_def_cfa_offset 3
  80               		.cfi_offset 28, -2
  81 002a DF93      		push r29
  82               		.cfi_def_cfa_offset 4
  83               		.cfi_offset 29, -3
  84               	/* prologue: function */
  85               	/* frame size = 0 */
  86               	/* stack size = 2 */
  87               	.L__stack_usage = 2
  32:serial/serial.c **** 	char c;
  88               		.loc 1 32 2 is_stmt 1 view .LVU18
  33:serial/serial.c **** 	while((c = *s++))
  89               		.loc 1 33 2 view .LVU19
  90               	.L7:
  91               	.LVL2:
  92               		.loc 1 33 8 view .LVU20
  93               		.loc 1 33 15 is_stmt 0 view .LVU21
  94 002c EC01      		movw r28,r24
  95               	.LVL3:
  96               		.loc 1 33 11 view .LVU22
  97 002e 8991      		ld r24,Y+
  98               	.LVL4:
  99               		.loc 1 33 8 view .LVU23
 100 0030 8111      		cpse r24,__zero_reg__
 101 0032 00C0      		rjmp .L8
 102               	/* epilogue start */
  34:serial/serial.c **** 	{
  35:serial/serial.c **** 		serial_tx(c);
  36:serial/serial.c **** 	}
  37:serial/serial.c **** }
 103               		.loc 1 37 1 view .LVU24
 104 0034 DF91      		pop r29
 105 0036 CF91      		pop r28
 106               	.LVL5:
 107               		.loc 1 37 1 view .LVU25
 108 0038 0895      		ret
 109               	.LVL6:
 110               	.L8:
  35:serial/serial.c **** 	}
 111               		.loc 1 35 3 is_stmt 1 view .LVU26
 112 003a 0E94 0000 		call serial_tx
 113               	.LVL7:
  33:serial/serial.c **** 	while((c = *s++))
 114               		.loc 1 33 15 is_stmt 0 view .LVU27
 115 003e CE01      		movw r24,r28
 116 0040 00C0      		rjmp .L7
 117               		.cfi_endproc
 118               	.LFE3:
 120               	.global	serial_tx_str_P
 122               	serial_tx_str_P:
 123               	.LVL8:
 124               	.LFB4:
  38:serial/serial.c **** 
  39:serial/serial.c **** void serial_tx_str_P(const char *s)
  40:serial/serial.c **** {
 125               		.loc 1 40 1 is_stmt 1 view -0
 126               		.cfi_startproc
 127               		.loc 1 40 1 is_stmt 0 view .LVU29
 128 0042 CF93      		push r28
 129               		.cfi_def_cfa_offset 3
 130               		.cfi_offset 28, -2
 131 0044 DF93      		push r29
 132               		.cfi_def_cfa_offset 4
 133               		.cfi_offset 29, -3
 134               	/* prologue: function */
 135               	/* frame size = 0 */
 136               	/* stack size = 2 */
 137               	.L__stack_usage = 2
 138 0046 EC01      		movw r28,r24
  41:serial/serial.c **** 	char c;
 139               		.loc 1 41 2 is_stmt 1 view .LVU30
  42:serial/serial.c **** 	while((c = pgm_read_byte(s++)))
 140               		.loc 1 42 2 view .LVU31
 141               	.LVL9:
 142               	.L10:
 143               		.loc 1 42 8 view .LVU32
 144               	.LBB2:
 145               		.loc 1 42 13 view .LVU33
 146               		.loc 1 42 13 view .LVU34
 147               		.loc 1 42 13 view .LVU35
 148 0048 FE01      		movw r30,r28
 149               	/* #APP */
 150               	 ;  42 "serial/serial.c" 1
 151 004a 8491      		lpm r24, Z
 152               		
 153               	 ;  0 "" 2
 154               	.LVL10:
 155               		.loc 1 42 13 view .LVU36
 156               		.loc 1 42 13 is_stmt 0 view .LVU37
 157               	/* #NOAPP */
 158               	.LBE2:
 159               		.loc 1 42 8 view .LVU38
 160 004c 2196      		adiw r28,1
 161               	.LVL11:
 162               		.loc 1 42 8 view .LVU39
 163 004e 8111      		cpse r24,__zero_reg__
 164 0050 00C0      		rjmp .L11
 165               	/* epilogue start */
  43:serial/serial.c **** 	{
  44:serial/serial.c **** 		serial_tx(c);
  45:serial/serial.c **** 	}
  46:serial/serial.c **** }
 166               		.loc 1 46 1 view .LVU40
 167 0052 DF91      		pop r29
 168 0054 CF91      		pop r28
 169               	.LVL12:
 170               		.loc 1 46 1 view .LVU41
 171 0056 0895      		ret
 172               	.LVL13:
 173               	.L11:
  44:serial/serial.c **** 	}
 174               		.loc 1 44 3 is_stmt 1 view .LVU42
 175 0058 0E94 0000 		call serial_tx
 176               	.LVL14:
  44:serial/serial.c **** 	}
 177               		.loc 1 44 3 is_stmt 0 view .LVU43
 178 005c 00C0      		rjmp .L10
 179               		.cfi_endproc
 180               	.LFE4:
 182               	.Letext0:
 183               		.file 2 "/usr/lib/gcc/avr/12.2.0/include/stdint-gcc.h"
DEFINED SYMBOLS
                            *ABS*:00000000 serial.c
     /tmp/ccfeKEjC.s:2      *ABS*:0000003e __SP_H__
     /tmp/ccfeKEjC.s:3      *ABS*:0000003d __SP_L__
     /tmp/ccfeKEjC.s:4      *ABS*:0000003f __SREG__
     /tmp/ccfeKEjC.s:5      *ABS*:00000000 __tmp_reg__
     /tmp/ccfeKEjC.s:6      *ABS*:00000001 __zero_reg__
     /tmp/ccfeKEjC.s:13     .text:00000000 serial_init
     /tmp/ccfeKEjC.s:16     .text:00000000 .Loc.0
     /tmp/ccfeKEjC.s:17     .text:00000000 L0
     /tmp/ccfeKEjC.s:22     .text:00000000 .Loc.1
     /tmp/ccfeKEjC.s:23     .text:00000000 .Loc.2
     /tmp/ccfeKEjC.s:26     .text:00000006 .Loc.3
     /tmp/ccfeKEjC.s:27     .text:00000006 .Loc.4
     /tmp/ccfeKEjC.s:30     .text:0000000c .Loc.5
     /tmp/ccfeKEjC.s:31     .text:0000000c .Loc.6
     /tmp/ccfeKEjC.s:37     .text:00000018 .Loc.7
     /tmp/ccfeKEjC.s:39     .text:0000001a L0
     /tmp/ccfeKEjC.s:44     .text:0000001a serial_tx
     /tmp/ccfeKEjC.s:46     .text:0000001a .Loc.8
     /tmp/ccfeKEjC.s:47     .text:0000001a L0
     /tmp/ccfeKEjC.s:54     .text:0000001a .Loc.9
     /tmp/ccfeKEjC.s:55     .text:0000001a .Loc.10
     /tmp/ccfeKEjC.s:56     .text:0000001a .Loc.11
     /tmp/ccfeKEjC.s:58     .text:0000001e .Loc.12
     /tmp/ccfeKEjC.s:61     .text:00000022 .Loc.13
     /tmp/ccfeKEjC.s:62     .text:00000022 .Loc.14
     /tmp/ccfeKEjC.s:65     .text:00000026 .Loc.15
     /tmp/ccfeKEjC.s:67     .text:00000028 L0
     /tmp/ccfeKEjC.s:72     .text:00000028 serial_tx_str
     /tmp/ccfeKEjC.s:75     .text:00000028 .Loc.16
     /tmp/ccfeKEjC.s:76     .text:00000028 L0
     /tmp/ccfeKEjC.s:77     .text:00000028 .Loc.17
     /tmp/ccfeKEjC.s:88     .text:0000002c .Loc.18
     /tmp/ccfeKEjC.s:89     .text:0000002c .Loc.19
     /tmp/ccfeKEjC.s:92     .text:0000002c .Loc.20
     /tmp/ccfeKEjC.s:93     .text:0000002c .Loc.21
     /tmp/ccfeKEjC.s:96     .text:0000002e .Loc.22
     /tmp/ccfeKEjC.s:99     .text:00000030 .Loc.23
     /tmp/ccfeKEjC.s:103    .text:00000034 .Loc.24
     /tmp/ccfeKEjC.s:107    .text:00000038 .Loc.25
     /tmp/ccfeKEjC.s:111    .text:0000003a .Loc.26
     /tmp/ccfeKEjC.s:114    .text:0000003e .Loc.27
     /tmp/ccfeKEjC.s:117    .text:00000042 L0
     /tmp/ccfeKEjC.s:122    .text:00000042 serial_tx_str_P
     /tmp/ccfeKEjC.s:125    .text:00000042 .Loc.28
     /tmp/ccfeKEjC.s:126    .text:00000042 L0
     /tmp/ccfeKEjC.s:127    .text:00000042 .Loc.29
     /tmp/ccfeKEjC.s:139    .text:00000048 .Loc.30
     /tmp/ccfeKEjC.s:140    .text:00000048 .Loc.31
     /tmp/ccfeKEjC.s:143    .text:00000048 .Loc.32
     /tmp/ccfeKEjC.s:145    .text:00000048 .Loc.33
     /tmp/ccfeKEjC.s:146    .text:00000048 .Loc.34
     /tmp/ccfeKEjC.s:147    .text:00000048 .Loc.35
     /tmp/ccfeKEjC.s:155    .text:0000004c .Loc.36
     /tmp/ccfeKEjC.s:156    .text:0000004c .Loc.37
     /tmp/ccfeKEjC.s:159    .text:0000004c .Loc.38
     /tmp/ccfeKEjC.s:162    .text:0000004e .Loc.39
     /tmp/ccfeKEjC.s:166    .text:00000052 .Loc.40
     /tmp/ccfeKEjC.s:170    .text:00000056 .Loc.41
     /tmp/ccfeKEjC.s:174    .text:00000058 .Loc.42
     /tmp/ccfeKEjC.s:177    .text:0000005c .Loc.43
     /tmp/ccfeKEjC.s:179    .text:0000005e L0
     /tmp/ccfeKEjC.s:184    .text:0000005e L0
                     .debug_frame:00000000 L0
     /tmp/ccfeKEjC.s:53     .text:0000001a .L3
     /tmp/ccfeKEjC.s:110    .text:0000003a .L8
     /tmp/ccfeKEjC.s:90     .text:0000002c .L7
     /tmp/ccfeKEjC.s:173    .text:00000058 .L11
     /tmp/ccfeKEjC.s:142    .text:00000048 .L10
     /tmp/ccfeKEjC.s:342    .debug_abbrev:00000000 .Ldebug_abbrev0
     /tmp/ccfeKEjC.s:8      .text:00000000 .Ltext0
     /tmp/ccfeKEjC.s:182    .text:0000005e .Letext0
     /tmp/ccfeKEjC.s:781    .debug_line:00000000 .Ldebug_line0
     /tmp/ccfeKEjC.s:124    .text:00000042 .LFB4
     /tmp/ccfeKEjC.s:180    .text:0000005e .LFE4
     /tmp/ccfeKEjC.s:575    .debug_loclists:00000018 .LLST3
     /tmp/ccfeKEjC.s:562    .debug_loclists:0000000c .LVUS3
     /tmp/ccfeKEjC.s:634    .debug_loclists:00000051 .LLST4
     /tmp/ccfeKEjC.s:631    .debug_loclists:0000004f .LVUS4
     /tmp/ccfeKEjC.s:144    .text:00000048 .LBB2
     /tmp/ccfeKEjC.s:158    .text:0000004c .LBE2
     /tmp/ccfeKEjC.s:648    .debug_loclists:0000005d .LLST5
     /tmp/ccfeKEjC.s:641    .debug_loclists:00000057 .LVUS5
     /tmp/ccfeKEjC.s:680    .debug_loclists:0000007b .LLST6
     /tmp/ccfeKEjC.s:677    .debug_loclists:00000079 .LVUS6
     /tmp/ccfeKEjC.s:176    .text:0000005c .LVL14
     /tmp/ccfeKEjC.s:74     .text:00000028 .LFB3
     /tmp/ccfeKEjC.s:118    .text:00000042 .LFE3
     /tmp/ccfeKEjC.s:698    .debug_loclists:0000008b .LLST1
     /tmp/ccfeKEjC.s:687    .debug_loclists:00000081 .LVUS1
     /tmp/ccfeKEjC.s:750    .debug_loclists:000000bd .LLST2
     /tmp/ccfeKEjC.s:747    .debug_loclists:000000bb .LVUS2
     /tmp/ccfeKEjC.s:113    .text:0000003e .LVL7
     /tmp/ccfeKEjC.s:45     .text:0000001a .LFB2
     /tmp/ccfeKEjC.s:68     .text:00000028 .LFE2
     /tmp/ccfeKEjC.s:760    .debug_loclists:000000c5 .LLST0
     /tmp/ccfeKEjC.s:757    .debug_loclists:000000c3 .LVUS0
     /tmp/ccfeKEjC.s:14     .text:00000000 .LFB1
     /tmp/ccfeKEjC.s:40     .text:0000001a .LFE1
     /tmp/ccfeKEjC.s:185    .debug_info:00000000 .Ldebug_info0

NO UNDEFINED SYMBOLS
